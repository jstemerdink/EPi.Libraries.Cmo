eval(function(h,b,d,g,f,i){f=function(a){return(a<62?"":f(parseInt(a/62)))+((a=a%62)>35?String.fromCharCode(a+29):a.toString(36))};if("0".replace(0,f)==0){while(d--){i[f(d)]=g[d]}g=[function(a){return i[a]||a}];f=function(){return"[3-9q-suw-zA-Y]"};d=1}while(d--){if(g[d]){h=h.replace(new RegExp("\\b"+f(d)+"\\b","g"),g[d])}}return h}(';(6(h){h.w.L=6(){5 j=6(a,f,c,g){5 d=document.createElement("S");d.r=f,d.G=c;5 b=a.C;5 e=b.s;3(!a.z){a.z={};y(5 i=0;i<e;i++){a.z[b[i].r]=i}}3(9 a.z[f]=="T")a.z[f]=e;a.C[a.z[f]]=d;3(g){d.u=8}};5 k=U;3(k.s==0)7 4;5 l=8;5 m=A;5 n,o,p;3(9(k[0])=="D"){m=8;n=k[0]}3(k.s>=2){3(9(k[1])=="M")l=k[1];q 3(9(k[2])=="M")l=k[2];3(!m){o=k[0];p=k[1]}}4.x(6(){3(4.E.B()!="F")7;3(m){y(5 a in n){j(4,a,n[a],l)}}q{j(4,o,p,l)}});7 4};h.w.ajaxAddOption=6(c,g,d,b,e){3(9(c)!="I")7 4;3(9(g)!="D")g={};3(9(d)!="M")d=8;4.x(6(){5 f=4;h.getJSON(c,g,6(a){h(f).L(a,d);3(9 b=="6"){3(9 e=="D"){b.apply(f,e)}q{b.N(f)}}})});7 4};h.w.V=6(){5 d=U;3(d.s==0)7 4;5 b=9(d[0]);5 e,i;3(b=="I"||b=="D"||b=="6"){e=d[0];3(e.H==W){5 j=e.s;y(5 k=0;k<j;k++){4.V(e[k],d[1])}7 4}}q 3(b=="number")i=d[0];q 7 4;4.x(6(){3(4.E.B()!="F")7;3(4.z)4.z=X;5 a=A;5 f=4.C;3(!!e){5 c=f.s;y(5 g=c-1;g>=0;g--){3(e.H==O){3(f[g].r.P(e)){a=8}}q 3(f[g].r==e){a=8}3(a&&d[1]===8)a=f[g].u;3(a){f[g]=X}a=A}}q{3(d[1]===8){a=f[i].u}q{a=8}3(a){4.remove(i)}}});7 4};h.w.sortOptions=6(e){5 i=h(4).Y();5 j=9(e)=="T"?8:!!e;4.x(6(){3(4.E.B()!="F")7;5 c=4.C;5 g=c.s;5 d=[];y(5 b=0;b<g;b++){d[b]={v:c[b].r,t:c[b].G}}d.sort(6(a,f){J=a.t.B(),K=f.t.B();3(J==K)7 0;3(j){7 J<K?-1:1}q{7 J>K?-1:1}});y(5 b=0;b<g;b++){c[b].G=d[b].t;c[b].r=d[b].v}}).Q(i,8);7 4};h.w.Q=6(g,d){5 b=g;5 e=9(g);3(e=="D"&&b.H==W){5 i=4;h.x(b,6(){i.Q(4,d)})};5 j=d||A;3(e!="I"&&e!="6"&&e!="D")7 4;4.x(6(){3(4.E.B()!="F")7 4;5 a=4.C;5 f=a.s;y(5 c=0;c<f;c++){3(b.H==O){3(a[c].r.P(b)){a[c].u=8}q 3(j){a[c].u=A}}q{3(a[c].r==b){a[c].u=8}q 3(j){a[c].u=A}}}});7 4};h.w.copyOptions=6(g,d){5 b=d||"u";3(h(g).size()==0)7 4;4.x(6(){3(4.E.B()!="F")7 4;5 a=4.C;5 f=a.s;y(5 c=0;c<f;c++){3(b=="all"||(b=="u"&&a[c].u)){h(g).L(a[c].r,a[c].G)}}});7 4};h.w.containsOption=6(g,d){5 b=A;5 e=g;5 i=9(e);5 j=9(d);3(i!="I"&&i!="6"&&i!="D")7 j=="6"?4:b;4.x(6(){3(4.E.B()!="F")7 4;3(b&&j!="6")7 A;5 a=4.C;5 f=a.s;y(5 c=0;c<f;c++){3(e.H==O){3(a[c].r.P(e)){b=8;3(j=="6")d.N(a[c],c)}}q{3(a[c].r==e){b=8;3(j=="6")d.N(a[c],c)}}}});7 j=="6"?4:b};h.w.Y=6(){5 a=[];4.R().x(6(){a[a.s]=4.r});7 a};h.w.selectedTexts=6(){5 a=[];4.R().x(6(){a[a.s]=4.G});7 a};h.w.R=6(){7 4.find("S:u")}})(jQuery);',[],61,"|||if|this|var|function|return|true|typeof|||||||||||||||||else|value|length||selected||fn|each|for|cache|false|toLowerCase|options|object|nodeName|select|text|constructor|string|o1t|o2t|addOption|boolean|call|RegExp|match|selectOptions|selectedOptions|option|undefined|arguments|removeOption|Array|null|selectedValues".split("|"),0,{}));jQuery.cookie=function(h,m,j){if(typeof m!="undefined"){j=j||{};if(m===null){m="";j.expires=-1}var f="";if(j.expires&&(typeof j.expires=="number"||j.expires.toUTCString)){var d;if(typeof j.expires=="number"){d=new Date();d.setTime(d.getTime()+(j.expires*24*60*60*1000))}else{d=j.expires}f="; expires="+d.toUTCString()}var k=j.path?"; path="+(j.path):"";var e=j.domain?"; domain="+(j.domain):"";var l=j.secure?"; secure":"";document.cookie=[h,"=",encodeURIComponent(m),f,k,e,l].join("")}else{var c=null;if(document.cookie&&document.cookie!=""){var b=document.cookie.split(";");for(var g=0;g<b.length;g++){var a=jQuery.trim(b[g]);if(a.substring(0,h.length+1)==(h+"=")){c=decodeURIComponent(a.substring(h.length+1));break}}}return c}};var _refreshPart=null;function RefreshBodyPart(g,d,e,f){var b=document.frames.__epLoaderFrame;if(b==null){b=document.createElement("IFRAME");b.id="__epLoaderFrame";b.name="__epLoaderFrame";b.attachEvent("onload",RefreshBodyPartOnLoad);b.style.display="none";document.body.appendChild(b)}_refreshPart=g;if(d==null){d=document.location.href}if(e!=null&&f!=null){if(b.document.body!=null){b.document.body.innerHTML=""}else{b.document.write("<HTML><BODY></BODY></HTML>")}var a=document.createElement('<form name="form" method="post" action="'+d+'"></form>');var c=document.createElement('<input type="hidden" name="'+e+'" value="">');a.appendChild(c);b.document.body.innerHTML=a.outerHTML;if(f.value){b.document.form.elements[e].value=f.value}else{b.document.form.elements[e].value=f}b.document.form.submit()}else{b.document.location.href=d}}function RefreshBodyPartOnLoad(){var a=document.frames.__epLoaderFrame;var b=this.document.all[_refreshPart];var c=a.document.all[_refreshPart];if(b!=null&&c!=null){b.insertAdjacentElement("beforeBegin",c);b.parentElement.removeChild(b)}}function DeleteRow(a){a.parentElement.deleteRow(a.rowIndex);return false}function SecMoveOption(d,e){while(d.selectedIndex>=0){var c=d.selectedIndex;var b=new Option(d.options[c].text,d.options[c].value);try{e.add(b)}catch(a){e.add(b,null)}d.remove(c)}}function ShowPopupBlockedInfo(){alert(EPi.Translate("/javascript/system/popupsblocked"))}function OpenDialogMembershipDeleteUserOrRole(g,h,a,b,c){var i=EPi.ResolveUrlFromUI("admin/DeleteMembershipDialog.aspx")+"?NameRoleOrUser="+g+"&SecurityEntity="+h;var d=300;var e=550;try{EPi.CreateDialog(i,a,b,c,{width:e,height:d})}catch(f){ShowPopupBlockedInfo()}return false}function MembershipDeleteCompleted(b,a){if(b){reloadPage()}}function OpenDialogUserAndGroupBrowser(j,i,g,a,b,c,d){var i=(i==""?"":"&search="+encodeURIComponent(i));var k=g+"/MembershipBrowser.aspx?type="+j+i+"&AllowMultiple="+a;var e=580;var f=550;try{EPi.CreateDialog(k,b,c,d,{width:f,height:e})}catch(h){ShowPopupBlockedInfo()}return false}function BrowserDialogCompleted(d,b){var a;if(!d){return}for(var c=0;c<d.length;c++){a=d[c].split(";");addRows(a[0],a[1])}}function BrowserPermissionDialogCompleted(d,b){var a;if(!d){return}for(var c=0;c<d.length;c++){a=d[c].split(";");addPermissionRows(a[0],a[1])}}function ToggleElementsInContainer(a,d){var b=getForm();for(var c=0;c<b.elements.length;c++){if(IsElementInContainer(a,b.elements[c])&&b.elements[c]!=d){b.elements[c].disabled=!(b.elements[c].disabled)}}}function IsElementInContainer(a,b){var c=b;while(c=c.parentElement){if(c==a){return true}}return false}function SimulateFormField(c,d){var a=getForm();if(!a.elements[c]){var b=document.createElement("input");b.type="hidden";b.name=c;b.id=c;b.value=d;a.appendChild(b)}}function getForm(){if(window.event==null){return document.forms[0]}var a=findParentForm(window.event.srcElement);if(!a&&document.forms.length>0){a=document.forms[0]}return a}function findParentForm(a){var b=a;while(b=b.parentElement){if(b.tagName.toLowerCase()=="form"){return b}}return null}var EPi;if(!EPi){EPi={}}EPi.GetOffset=function(a){var b=0;var c=0;if(a.offsetParent){while(a.offsetParent&&a.tagName.toLowerCase()!="body"){b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent}}var d=[b,c];return d};EPi.Form={};EPi.Form._isRegistered=false;EPi.Form.SetOnSubmit=function(){EPi.Form._isRegistered=true;var a=EPi.GetForm();if(a.onsubmit){EPi.Form.RegisterSubmitHandler(a.onsubmit)}a.onsubmit=EPi.Form._OnSubmit};EPi.Form._OnSubmit=function(a){if(!a){a=window.event}if(a&&a.type=="submit"&&!document.addEventListener){return}var b="submit";if(document.addEventListener){b="episubmit"}return EPi.DispatchEvent(EPi.GetForm(),b)};EPi.Form.RegisterSubmitHandler=function(b){var a=function(c){if(b()==false){c.preventDefault()}};EPi.AddEventListener(EPi.GetForm(),"submit",a)};function RegisterSubmitHandler(a){EPi.Form.RegisterSubmitHandler(a)}EPi.Tab={};EPi.Tab.Click=function(d,b,c,a){if(a){a.Close()}a.oTab=d.id;a.oBody=b;a.oInput=c;a.Open()};EPi.Tab.Control=function(c,a,b){this.oTab=c;this.oBody=a;this.oInput=b;this.Close=function(){if(typeof(this.oBody)=="string"&&document.getElementById(this.oBody)){document.getElementById(this.oBody).className="epitabobjectinactive"}EPi.Tab.SwitchTabClass(document.getElementById(this.oTab),false);document.getElementById(this.oInput).value=""};this.Open=function(){if(typeof(this.oBody)=="string"&&document.getElementById(this.oBody)){document.getElementById(this.oBody).className="epitabobjectactive"}EPi.Tab.SwitchTabClass(document.getElementById(this.oTab),true);document.getElementById(this.oInput).value="TabClicked"}};EPi.Tab.SwitchTabClass=function(c,a){var d=c.childNodes;for(var b=0;b<d.length;b++){if(a){switch(d[b].className){case"epitabinactiveleft":d[b].className="epitabactiveleft";break;case"epitabinactiveright":d[b].className="epitabactiveright";break;case"epitabinactive":d[b].className="epitabactive";break;default:break}}else{switch(d[b].className){case"epitabactiveleft":d[b].className="epitabinactiveleft";break;case"epitabactiveright":d[b].className="epitabinactiveright";break;case"epitabactive":d[b].className="epitabinactive";break}}}};EPi.ResizeWindow=function(a){EPi.RemoveEventListener(window,"load",EPi.ResizeWindow);EPi.ResizeWindow._resize(a);EPi.AddEventListener(window,"resize",EPi.ResizeWindow._resize)};EPi.ResizeWindow.ElementsArray=new Array();EPi.ResizeWindow.Add=function(c){var d=EPi.ResizeWindow.ElementsArray;var a=false;for(var b=0;b<d.length;b++){if(c==d[b]){a=true;break}}if(!a){EPi.ResizeWindow.ElementsArray.push(c);EPi.ResizeWindow._resize();EPi.AddEventListener(window,"resize",EPi.ResizeWindow._resize)}};EPi.ResizeWindow._resize=function(b){if(EPi.ResizeWindow.ElementsArray.length==0){return}var d,g;var a=new Array();var f=EPi.ResizeWindow.ElementsArray.length;var c=EPi.GetForm();for(d=0;d<f;d++){g=document.getElementById(EPi.ResizeWindow.ElementsArray[d]);if(g==null){return}a[d]=EPi.GetCurrentStyle(g,"display");g.style.display="none"}for(d=0;d<f;d++){g=document.getElementById(EPi.ResizeWindow.ElementsArray[d]);g.style.height=Math.max((document.documentElement.clientHeight-c.offsetHeight-12),0)+"px"}for(d=0;d<f;d++){g=document.getElementById(EPi.ResizeWindow.ElementsArray[d]);if(a[d]=="none"||a[d]=="inline"){a[d]="block"}g.style.display=a[d]}};EPi.ToolButton={};EPi.ToolButton.SetEnabled=function(a,d){var b=EPi._GetDomObject(a);if(typeof(b)!="object"){return}var e=b.parentNode;if(d){var c=e.className.replace(/disabled/,"");if(e.className!=c){e.className=c}b.removeAttribute("disabled")}else{if(!b.disabled){b.setAttribute("disabled","disabled");var c=e.className.replace(/disabled/,"");e.className+="disabled"}}};EPi.ToolButton.MouseDownHandler=function(a){a.parentNode.className+=" epitoolbuttonmousedown"};EPi.ToolButton.ResetMouseDownHandler=function(b){var a=b.parentNode.className.replace(/ epitoolbuttonmousedown/,"");b.parentNode.className=a};EPi.GetDialog=function(){if(window.opener&&window.opener.EPiOpenedDialog){return window.opener.EPiOpenedDialog}else{if(window.top.EPiOpenedDialog){return window.top.EPiOpenedDialog}}};EPi.CreateDialog=function(f,b,a,d,e){var c=new EPi.Dialog(b,a,d);c.Initialize(f,e);return c};EPi.CreatePageBrowserDialog=function(k,h,e,f,i,l,j,b,a){var c=k+"?id="+h+"&disablecurrentpageoption="+e+"&info="+i+"&value="+l+"&epslanguage="+j+"&displaywarning="+f;if(!b){b=function(m){if(m){if(document.getElementById(i).onchange){}else{EPi.PageLeaveCheck.SetPageChanged(true)}}}}if(!a){a=null}var d=window.document;var g={width:380,height:550};return EPi.CreateDialog(c,b,a,d,g)};EPi.CreateDateBrowserDialog=function(d,c,a){if(!d){d=EPi.ResolveUrlFromUtil("DateBrowser.aspx")}d+="?value="+document.getElementById(c).value;if(!a){a=function(g,e){if(typeof(g)!="undefined"){var f=document.getElementById(e);f.value=g;EPi.DispatchEvent(f,"change")}}}var b={width:240,height:300,scrollbars:"no"};return EPi.CreateDialog(d,a,c,null,b)};EPi.Dialog=function(b,a,c){this.callbackMethod=b||null;this.callbackArguments=a||null;this.dialogArguments=c||null;this._opener=window.top;this._opener.EPiOpenedDialog=this};EPi.Dialog.CreateCover=function(){var win=window.top;if(!win.epiDialogCover){var coverFrame=win.epiDialogCover=win.document.createElement("iframe");with(coverFrame.style){position="absolute";top=0;left=0;width="100%";height="100%";overflow="hidden";border=0;backgroundColor="#101010";zIndex=10000;display="none";opacity=0.01;filter="alpha(opacity=1)"}EPi.AddEventListener(coverFrame,"load",function(e){EPi.AddEventListener(this.contentWindow.document,"click",EPi.Dialog._SetFocusToOpenedDialog)});win.document.body.appendChild(coverFrame)}};EPi.Dialog._SetFocusToOpenedDialog=function(a){if(window.top.EPiOpenedDialog){window.top.EPiOpenedDialog._SetFocus()}};var _p=EPi.Dialog.prototype;_p.callbackMethod=null;_p._dialog=null;_p._opener=null;_p.Close=function(a){this._CleanUpAndReturn(a)};_p.Initialize=function(d,b){this._SetDialogFeatures(b);var c=this._opener;try{this._dialog=c.open(d,"","menubar=no,location=no,resizable="+this.resizable+",scrollbars="+this.scrollbars+",status=no, width="+parseInt(this.width)+", height="+parseInt(this.height)+", top="+parseInt(this.top)+", left="+parseInt(this.left))}catch(a){ShowPopupBlockedInfo();this._CleanEvents();this._CleanElements();this.Close(null);return}if(c.epiDialogCover==null){EPi.Dialog.CreateCover()}c.epiDialogCover.style.display="block";this._AddEvents()};_p._SetDialogFeatures=function(a){var c=window.top;if(typeof(a)=="object"){for(var d in a){this[d.toLowerCase()]=a[d]}}if(!this.resizable){this.resizable="yes"}if(!this.scrollbars){this.scrollbars="yes"}if(!this.width){this.width=510}if(!this.height){this.height=500}if(this.width>window.screen.availWidth-50){this.width=window.screen.availWidth-50;this.left=20}if(this.height>window.screen.availHeight-100){this.height=window.screen.availHeight-100;this.top=20}if(!this.left){if(c.innerWidth){this.left=c.screenX+c.innerWidth/2-this.width/2}else{this.left=c.screenLeft+c.document.body.offsetWidth/2-this.width/2}}if(!this.top){if(c.innerHeight){this.top=c.screenY+c.innerHeight/2-this.height/2}else{this.top=c.screenTop+c.document.body.offsetHeight/2-this.height/2}var b=Math.max(0,this.left);var e=Math.max(0,this.top);this.left=b;this.top=e}};_p._DialogUnload=function(b){var a=this;var c=this.opener.EPiOpenedDialog;EPi.RemoveEventListener(this,"unload",c._DialogUnload);function d(){if(c._dialog){var e=a.closed;if(e){c._CleanUpAndReturn(null)}else{c._AddUnLoadEventListener()}}}this.opener.setTimeout(d,1)};_p._AddUnLoadEventListener=function(){EPi.AddEventListener(this._dialog,"unload",this._DialogUnload)};_p._CleanUpAndReturn=function(c){var b;if(this._dialog!=null){if(!this._dialog.closed&&this._dialog.EPi&&this._dialog.EPi.PageLeaveCheck&&this._dialog.EPi.PageLeaveCheck.trigger==null&&this._dialog.EPi.PageLeaveCheck.HasPageChanged()){if(this._dialog.EPiObject&&this._dialog.EPiObject.pageLeaveMessage){b=this._dialog.EPiObject.pageLeaveMessage}else{b=EPi.Translate("/system/editutil/leavepagewarning")}var a=this._dialog.confirm(b);if(!a){return}else{this._dialog.EPi.PageLeaveCheck.enabled=false}}if(!this._dialog.closed){EPi.RemoveEventListener(this._dialog,"unload",this._DialogUnload);this._dialog.close()}this._CleanEvents();this._CleanElements()}this._CleanDialog();window.top.EPiOpenedDialog=null;this._opener.EPiOpenedDialog=null;delete this._opener;if(typeof(this.callbackMethod)=="function"){this.callbackMethod(c,this.callbackArguments)}this.callbackMethod=null;this.callbackArguments=null;delete this.callbackMethod;delete this.callbackArguments};_p._AddEvents=function(){EPi.AddEventListener(window.top,"unload",this._OnOpenerUnload);EPi.AddEventListener(window.top,"focus",this._SetFocus);this._AddUnLoadEventListener()};_p._CleanEvents=function(){EPi.RemoveEventListener(window.top,"unload",this._OnOpenerUnload);EPi.RemoveEventListener(window.top,"focus",this._SetFocus)};_p._OnOpenerUnload=function(){if(this.EPiOpenedDialog){this.EPiOpenedDialog._CleanUpAndReturn(null)}};_p._SetFocus=function(a){if(window.top.EPiOpenedDialog&&window.top.EPiOpenedDialog._dialog){if(window.top.EPiOpenedDialog._dialog.closed){window.top.EPiOpenedDialog._CleanUpAndReturn(null)}else{window.top.EPiOpenedDialog._dialog.focus()}}};_p._CleanElements=function(){if(window.top.epiDialogCover){window.top.epiDialogCover.style.display="none"}};_p._CleanDialog=function(){for(var a in this){if(a!="callbackMethod"&&a!="callbackArguments"&&a!="_opener"){this[a]=null;delete this[a]}}};EPi.ReportWindowOpen=function(){var g=EPi.ResolveUrlFromUI("Report/Default.aspx");var a=window.screen.availHeight;var b=window.screen.availWidth;var e=window.top;e.name="EPiServerMainUI";var h=Math.min(b,1024);var c=Math.min(a,768);var d;var f;if(e.innerWidth){d=e.screenX+e.innerWidth/2-h/2;f=e.screenY+e.innerHeight/2-c/2}else{d=e.screenLeft+e.document.body.offsetWidth/2-h/2;f=e.screenTop+e.document.body.offsetHeight/2-c/2}if(h==b){h-=50;d=20}if(c==a){c-=50;f=20}var i=e.open(g,"ReportCenter","width="+h+", height="+c+", top="+f+", left="+d+", status=no, resizable, scrollbars");i.resizeTo(h,c);i.focus()};EPi.ArrayContains=function(a,d){if(a==null||d==null){return false}var b;var c=a.length;for(b=0;b<c;b++){if(a[b]==d){return true}}return false};EPi.StringContainsWord=function(a,b){if(a==null||b==null){return false}return(new RegExp("(?:\\s|^)"+b+"(?:\\s|$)")).test(a)};EPi.HtmlDecode=function(s){var out="";if(s==null||s==""){return}var l=s.length;for(var i=0;i<l;i++){var ch=s.charAt(i);if(ch=="&"){var semicolonIndex=s.indexOf(";",i+1);if(semicolonIndex>0){var entity=s.substring(i+1,semicolonIndex);if(entity.length>1&&entity.charAt(0)=="#"){if(entity.charAt(1)=="x"||entity.charAt(1)=="X"){ch=String.fromCharCode(eval("0"+entity.substring(1)))}else{ch=String.fromCharCode(eval(entity.substring(1)))}}else{switch(entity){case"quot":ch=String.fromCharCode(34);break;case"amp":ch=String.fromCharCode(38);break;case"lt":ch=String.fromCharCode(60);break;case"gt":ch=String.fromCharCode(62);break;case"nbsp":ch=String.fromCharCode(160);break;case"iexcl":ch=String.fromCharCode(161);break;case"cent":ch=String.fromCharCode(162);break;case"pound":ch=String.fromCharCode(163);break;case"curren":ch=String.fromCharCode(164);break;case"yen":ch=String.fromCharCode(165);break;case"brvbar":ch=String.fromCharCode(166);break;case"sect":ch=String.fromCharCode(167);break;case"uml":ch=String.fromCharCode(168);break;case"copy":ch=String.fromCharCode(169);break;case"ordf":ch=String.fromCharCode(170);break;case"laquo":ch=String.fromCharCode(171);break;case"not":ch=String.fromCharCode(172);break;case"shy":ch=String.fromCharCode(173);break;case"reg":ch=String.fromCharCode(174);break;case"macr":ch=String.fromCharCode(175);break;case"deg":ch=String.fromCharCode(176);break;case"plusmn":ch=String.fromCharCode(177);break;case"sup2":ch=String.fromCharCode(178);break;case"sup3":ch=String.fromCharCode(179);break;case"acute":ch=String.fromCharCode(180);break;case"micro":ch=String.fromCharCode(181);break;case"para":ch=String.fromCharCode(182);break;case"middot":ch=String.fromCharCode(183);break;case"cedil":ch=String.fromCharCode(184);break;case"sup1":ch=String.fromCharCode(185);break;case"ordm":ch=String.fromCharCode(186);break;case"raquo":ch=String.fromCharCode(187);break;case"frac14":ch=String.fromCharCode(188);break;case"frac12":ch=String.fromCharCode(189);break;case"frac34":ch=String.fromCharCode(190);break;case"iquest":ch=String.fromCharCode(191);break;case"Agrave":ch=String.fromCharCode(192);break;case"Aacute":ch=String.fromCharCode(193);break;case"Acirc":ch=String.fromCharCode(194);break;case"Atilde":ch=String.fromCharCode(195);break;case"Auml":ch=String.fromCharCode(196);break;case"Aring":ch=String.fromCharCode(197);break;case"AElig":ch=String.fromCharCode(198);break;case"Ccedil":ch=String.fromCharCode(199);break;case"Egrave":ch=String.fromCharCode(200);break;case"Eacute":ch=String.fromCharCode(201);break;case"Ecirc":ch=String.fromCharCode(202);break;case"Euml":ch=String.fromCharCode(203);break;case"Igrave":ch=String.fromCharCode(204);break;case"Iacute":ch=String.fromCharCode(205);break;case"Icirc":ch=String.fromCharCode(206);break;case"Iuml":ch=String.fromCharCode(207);break;case"ETH":ch=String.fromCharCode(208);break;case"Ntilde":ch=String.fromCharCode(209);break;case"Ograve":ch=String.fromCharCode(210);break;case"Oacute":ch=String.fromCharCode(211);break;case"Ocirc":ch=String.fromCharCode(212);break;case"Otilde":ch=String.fromCharCode(213);break;case"Ouml":ch=String.fromCharCode(214);break;case"times":ch=String.fromCharCode(215);break;case"Oslash":ch=String.fromCharCode(216);break;case"Ugrave":ch=String.fromCharCode(217);break;case"Uacute":ch=String.fromCharCode(218);break;case"Ucirc":ch=String.fromCharCode(219);break;case"Uuml":ch=String.fromCharCode(220);break;case"Yacute":ch=String.fromCharCode(221);break;case"THORN":ch=String.fromCharCode(222);break;case"szlig":ch=String.fromCharCode(223);break;case"agrave":ch=String.fromCharCode(224);break;case"aacute":ch=String.fromCharCode(225);break;case"acirc":ch=String.fromCharCode(226);break;case"atilde":ch=String.fromCharCode(227);break;case"auml":ch=String.fromCharCode(228);break;case"aring":ch=String.fromCharCode(229);break;case"aelig":ch=String.fromCharCode(230);break;case"ccedil":ch=String.fromCharCode(231);break;case"egrave":ch=String.fromCharCode(232);break;case"eacute":ch=String.fromCharCode(233);break;case"ecirc":ch=String.fromCharCode(234);break;case"euml":ch=String.fromCharCode(235);break;case"igrave":ch=String.fromCharCode(236);break;case"iacute":ch=String.fromCharCode(237);break;case"icirc":ch=String.fromCharCode(238);break;case"iuml":ch=String.fromCharCode(239);break;case"eth":ch=String.fromCharCode(240);break;case"ntilde":ch=String.fromCharCode(241);break;case"ograve":ch=String.fromCharCode(242);break;case"oacute":ch=String.fromCharCode(243);break;case"ocirc":ch=String.fromCharCode(244);break;case"otilde":ch=String.fromCharCode(245);break;case"ouml":ch=String.fromCharCode(246);break;case"divide":ch=String.fromCharCode(247);break;case"oslash":ch=String.fromCharCode(248);break;case"ugrave":ch=String.fromCharCode(249);break;case"uacute":ch=String.fromCharCode(250);break;case"ucirc":ch=String.fromCharCode(251);break;case"uuml":ch=String.fromCharCode(252);break;case"yacute":ch=String.fromCharCode(253);break;case"thorn":ch=String.fromCharCode(254);break;case"yuml":ch=String.fromCharCode(255);break;case"OElig":ch=String.fromCharCode(338);break;case"oelig":ch=String.fromCharCode(339);break;case"Scaron":ch=String.fromCharCode(352);break;case"scaron":ch=String.fromCharCode(353);break;case"Yuml":ch=String.fromCharCode(376);break;case"fnof":ch=String.fromCharCode(402);break;case"circ":ch=String.fromCharCode(710);break;case"tilde":ch=String.fromCharCode(732);break;case"Alpha":ch=String.fromCharCode(913);break;case"Beta":ch=String.fromCharCode(914);break;case"Gamma":ch=String.fromCharCode(915);break;case"Delta":ch=String.fromCharCode(916);break;case"Epsilon":ch=String.fromCharCode(917);break;case"Zeta":ch=String.fromCharCode(918);break;case"Eta":ch=String.fromCharCode(919);break;case"Theta":ch=String.fromCharCode(920);break;case"Iota":ch=String.fromCharCode(921);break;case"Kappa":ch=String.fromCharCode(922);break;case"Lambda":ch=String.fromCharCode(923);break;case"Mu":ch=String.fromCharCode(924);break;case"Nu":ch=String.fromCharCode(925);break;case"Xi":ch=String.fromCharCode(926);break;case"Omicron":ch=String.fromCharCode(927);break;case"Pi":ch=String.fromCharCode(928);break;case" Rho ":ch=String.fromCharCode(929);break;case"Sigma":ch=String.fromCharCode(931);break;case"Tau":ch=String.fromCharCode(932);break;case"Upsilon":ch=String.fromCharCode(933);break;case"Phi":ch=String.fromCharCode(934);break;case"Chi":ch=String.fromCharCode(935);break;case"Psi":ch=String.fromCharCode(936);break;case"Omega":ch=String.fromCharCode(937);break;case"alpha":ch=String.fromCharCode(945);break;case"beta":ch=String.fromCharCode(946);break;case"gamma":ch=String.fromCharCode(947);break;case"delta":ch=String.fromCharCode(948);break;case"epsilon":ch=String.fromCharCode(949);break;case"zeta":ch=String.fromCharCode(950);break;case"eta":ch=String.fromCharCode(951);break;case"theta":ch=String.fromCharCode(952);break;case"iota":ch=String.fromCharCode(953);break;case"kappa":ch=String.fromCharCode(954);break;case"lambda":ch=String.fromCharCode(955);break;case"mu":ch=String.fromCharCode(956);break;case"nu":ch=String.fromCharCode(957);break;case"xi":ch=String.fromCharCode(958);break;case"omicron":ch=String.fromCharCode(959);break;case"pi":ch=String.fromCharCode(960);break;case"rho":ch=String.fromCharCode(961);break;case"sigmaf":ch=String.fromCharCode(962);break;case"sigma":ch=String.fromCharCode(963);break;case"tau":ch=String.fromCharCode(964);break;case"upsilon":ch=String.fromCharCode(965);break;case"phi":ch=String.fromCharCode(966);break;case"chi":ch=String.fromCharCode(967);break;case"psi":ch=String.fromCharCode(968);break;case"omega":ch=String.fromCharCode(969);break;case"thetasym":ch=String.fromCharCode(977);break;case"upsih":ch=String.fromCharCode(978);break;case"piv":ch=String.fromCharCode(982);break;case"ensp":ch=String.fromCharCode(8194);break;case"emsp":ch=String.fromCharCode(8195);break;case"thinsp":ch=String.fromCharCode(8201);break;case"zwnj":ch=String.fromCharCode(8204);break;case"zwj":ch=String.fromCharCode(8205);break;case"lrm":ch=String.fromCharCode(8206);break;case"rlm":ch=String.fromCharCode(8207);break;case"ndash":ch=String.fromCharCode(8211);break;case"mdash":ch=String.fromCharCode(8212);break;case"lsquo":ch=String.fromCharCode(8216);break;case"rsquo":ch=String.fromCharCode(8217);break;case"sbquo":ch=String.fromCharCode(8218);break;case"ldquo":ch=String.fromCharCode(8220);break;case"rdquo":ch=String.fromCharCode(8221);break;case"bdquo":ch=String.fromCharCode(8222);break;case"dagger":ch=String.fromCharCode(8224);break;case"Dagger":ch=String.fromCharCode(8225);break;case"bull":ch=String.fromCharCode(8226);break;case"hellip":ch=String.fromCharCode(8230);break;case"permil":ch=String.fromCharCode(8240);break;case"prime":ch=String.fromCharCode(8242);break;case"Prime":ch=String.fromCharCode(8243);break;case"lsaquo":ch=String.fromCharCode(8249);break;case"rsaquo":ch=String.fromCharCode(8250);break;case"oline":ch=String.fromCharCode(8254);break;case"frasl":ch=String.fromCharCode(8260);break;case"euro":ch=String.fromCharCode(8364);break;case"image":ch=String.fromCharCode(8465);break;case"weierp":ch=String.fromCharCode(8472);break;case"real":ch=String.fromCharCode(8476);break;case"trade":ch=String.fromCharCode(8482);break;case"alefsym":ch=String.fromCharCode(8501);break;case"larr":ch=String.fromCharCode(8592);break;case"uarr":ch=String.fromCharCode(8593);break;case"rarr":ch=String.fromCharCode(8594);break;case"darr":ch=String.fromCharCode(8595);break;case"harr":ch=String.fromCharCode(8596);break;case"crarr":ch=String.fromCharCode(8629);break;case"lArr":ch=String.fromCharCode(8656);break;case"uArr":ch=String.fromCharCode(8657);break;case"rArr":ch=String.fromCharCode(8658);break;case"dArr":ch=String.fromCharCode(8659);break;case"hArr":ch=String.fromCharCode(8660);break;case"forall":ch=String.fromCharCode(8704);break;case"part":ch=String.fromCharCode(8706);break;case"exist":ch=String.fromCharCode(8707);break;case"empty":ch=String.fromCharCode(8709);break;case"nabla":ch=String.fromCharCode(8711);break;case"isin":ch=String.fromCharCode(8712);break;case"notin":ch=String.fromCharCode(8713);break;case"ni":ch=String.fromCharCode(8715);break;case"prod":ch=String.fromCharCode(8719);break;case"sum":ch=String.fromCharCode(8721);break;case"minus":ch=String.fromCharCode(8722);break;case"lowast":ch=String.fromCharCode(8727);break;case"radic":ch=String.fromCharCode(8730);break;case"prop":ch=String.fromCharCode(8733);break;case"infin":ch=String.fromCharCode(8734);break;case"ang":ch=String.fromCharCode(8736);break;case"and":ch=String.fromCharCode(8743);break;case"or":ch=String.fromCharCode(8744);break;case"cap":ch=String.fromCharCode(8745);break;case"cup":ch=String.fromCharCode(8746);break;case"int":ch=String.fromCharCode(8747);break;case"there4":ch=String.fromCharCode(8756);break;case"sim":ch=String.fromCharCode(8764);break;case"cong":ch=String.fromCharCode(8773);break;case"asymp":ch=String.fromCharCode(8776);break;case"ne":ch=String.fromCharCode(8800);break;case"equiv":ch=String.fromCharCode(8801);break;case"le":ch=String.fromCharCode(8804);break;case"ge":ch=String.fromCharCode(8805);break;case"sub":ch=String.fromCharCode(8834);break;case"sup":ch=String.fromCharCode(8835);break;case"nsub":ch=String.fromCharCode(8836);break;case"sube":ch=String.fromCharCode(8838);break;case"supe":ch=String.fromCharCode(8839);break;case"oplus":ch=String.fromCharCode(8853);break;case"otimes":ch=String.fromCharCode(8855);break;case"perp":ch=String.fromCharCode(8869);break;case"sdot":ch=String.fromCharCode(8901);break;case"lceil":ch=String.fromCharCode(8968);break;case"rceil":ch=String.fromCharCode(8969);break;case"lfloor":ch=String.fromCharCode(8970);break;case"rfloor":ch=String.fromCharCode(8971);break;case"lang":ch=String.fromCharCode(9001);break;case"rang":ch=String.fromCharCode(9002);break;case"loz":ch=String.fromCharCode(9674);break;case"spades":ch=String.fromCharCode(9824);break;case"clubs":ch=String.fromCharCode(9827);break;case"hearts":ch=String.fromCharCode(9829);break;case"diams":ch=String.fromCharCode(9830);break;default:ch="";break}}i=semicolonIndex}}out+=ch}return out};EPi.FireDefaultButton=function(c,b){this.OkToFire=function(f,d){var g=f.srcElement||f.target;if(!g&&!g.nodeName){return true}if(g==d){return false}switch(g.nodeName.toUpperCase()){case"TEXTAREA":case"A":case"BUTTON":return false;break;case"INPUT":switch(g.type.toUpperCase()){case"BUTTON":case"SUBMIT":case"IMAGE":case"RESET":case"FILE":return false}return true;break;default:return true}};var a=document.getElementById(b)||EPi.defaultButton;if(c.keyCode==13){if(this.OkToFire(c,a)){if(a&&a.click!="undefined"){a.click();c.cancelBubble=true;if(c.stopPropagation){c.stopPropagation()}return false}}}return true};EPi.InvokeFireDefaultButton=function(a){EPi.RemoveEventListener(window,"load",EPi.InvokeFireDefaultButton);if(typeof(window.WebForm_FireDefaultButton)!="undefined"&&typeof(EPi.GetForm().onkeypress)!="undefined"&&EPi.GetForm().onkeypress!=null&&EPi.GetForm().onkeypress.toString().indexOf("WebForm_FireDefaultButton")>0){window.WebForm_FireDefaultButton=function(c,b){return EPi.FireDefaultButton(c,b)}}};if(typeof(EPi.AddWindowLoadListener)=="function"){EPi.AddWindowLoadListener(EPi.InvokeFireDefaultButton)};(function(a){a.widget("ui.conversionPathEditor",{_init:function(){var c=this,b=this.options;this.pathNameTextBox=a("#"+b.pathNameTextBoxId);this.addRightButton=a("#"+b.addRightButtonId);this.addLeftButton=a("#"+b.addLeftButtonId);this.upButton=a("#"+b.upButtonId);this.downButton=a("#"+b.downButtonId);this.leftSelect=this.element.find("#"+b.leftListId);this.rightSelect=this.element.find("#"+b.rightListId);this.rightHidden=this.element.find("#"+b.rightListHiddenId);this.rightSelect.empty();if(this.rightHidden.val()){a.each(this.rightHidden.val().split(","),function(d,f){var e=a(c.leftSelect).find("option[value="+f+"]");if(e){e.clone().appendTo(c.rightSelect);e.addClass(b.disabledOptionClass)}})}this._afterListChange();this.leftSelect.dblclick(function(d){c.addRight()});this.rightSelect.dblclick(function(d){c.removeRight()});this.leftSelect.change(function(d){c._changeButtonsState()});this.rightSelect.change(function(d){c._changeButtonsState()});this.leftSelect.keydown(function(d){if(d.keyCode==13){c.addRight()}});this.rightSelect.keydown(function(d){if(d.keyCode==13){c.removeRight()}})},showEditor:function(){this.element.show()},hideEditor:function(){this._clearForm();this.element.hide();a("#"+this.options.validationSummaryId,this.element).hide();a("span[validationGroup="+this.options.validationGroupName+"]",this.element).hide()},addRight:function(){var b=this.leftSelect.find("option:selected");if(this.rightSelect.find("option[value="+b.attr("value")+"]").length>0){Cmo.ShowAlert(this.options.messages.pageExistMessageText)}else{if(this.rightSelect.find("option").length>=this.options.maximumPages){Cmo.ShowAlert(this.options.messages.cantAddMorePagesMessageText)}else{b.clone().appendTo(this.rightSelect);b.addClass(this.options.disabledOptionClass)}}this._afterListChange()},removeRight:function(){var b=this.rightSelect.find("option:selected");this.leftSelect.find("option[value="+b.attr("value")+"]").removeClass(this.options.disabledOptionClass);b.remove();this._afterListChange()},upRight:function(){var b=this.rightSelect.find("option:selected");b.insertBefore(b.prev());this._afterListChange()},downRight:function(){var b=this.rightSelect.find("option:selected");b.insertAfter(b.next());this._afterListChange()},getSelectedPagesCount:function(){return this.rightSelect.find("option").length},_afterListChange:function(){this._changeButtonsState();this._updateHidden()},_changeButtonsState:function(){var b=this.leftSelect.find("option:selected");var c=this.rightSelect.find("option");if(b.length==0||c.length>=this.options.maximumPages){this._disableButton(this.addRightButton)}else{this._enableButton(this.addRightButton)}var d=this.rightSelect.find("option:selected");if(d.length==0){this._disableButton(this.addLeftButton)}else{this._enableButton(this.addLeftButton)}if(d.length==1){if(d.prev().length==0){this._disableButton(this.upButton)}else{this._enableButton(this.upButton)}if(d.next().length==0){this._disableButton(this.downButton)}else{this._enableButton(this.downButton)}}else{this._disableButton(this.upButton);this._disableButton(this.downButton)}},_disableButton:function(b){b.attr("disabled","disabled");b.parent().addClass("epi-cmsButtondisabled");b.parent().removeClass("epitoolbuttonmousedown")},_enableButton:function(b){b.removeAttr("disabled");b.parent().removeClass("epi-cmsButtondisabled")},_updateHidden:function(){var b="";this.rightSelect.find("option").each(function(d,c){b+=a(c).attr("value")+","});this.rightHidden.val(b)},_clearForm:function(){this.pathNameTextBox.val("");this.rightSelect.empty();this.leftSelect.find("option").removeClass(this.options.disabledOptionClass);this._afterListChange()}});a.extend(a.ui.conversionPathEditor,{getter:"getSelectedPagesCount",defaults:{messages:{pageExistMessageText:"Page already selected",cantAddMorePagesMessageText:"Can not add more than 4 pages"},maximumPages:4,minimumPages:2,leftListId:"",rightListId:"",rightListHiddenId:"",addRightButtonId:"",addLeftButtonId:"",upButtonId:"",downButtonId:"",pathNameTextBoxId:"",disabledOptionClass:"CP-settings-disabledItem",validationSummaryId:"",validationGroupName:""}});a.widget("ui.conversionPathNameEditor",{_init:function(){var c=this,b=this.options;this.convertionNameOriginalHidden=a("#"+b.convertionNameOriginalHiddenId);this.isVisibleHidden=a("#"+b.isVisibleHiddenId);this.buttonOk=a("#"+b.buttonOkId);this.buttonRename=a("#"+b.buttonRenameId);this.buttonCancel=a("#"+b.buttonCancelId);this.textBoxName=a("#"+b.textBoxNameId);this.validationSummary=a("#"+b.validationSummaryId);this.requiredFieldValidator=a("#"+b.requiredFieldValidatorId);this.nameUniqueValidator=a("#"+b.nameUniqueValidatorId);this.label=a("#"+b.labelId);if(this.isVisibleHidden.val()=="true"){this.showEditor()}else{this.hideEditor()}},showEditor:function(){this._hideButton(this.buttonRename);this._showButton(this.buttonOk);this._showButton(this.buttonCancel);this._showElement(this.textBoxName);this._showElement(this.label)},cancelEditor:function(){this.hideEditor();this.textBoxName.val(this.convertionNameOriginalHidden.val())},hideEditor:function(){this._showButton(this.buttonRename);this._hideButton(this.buttonOk);this._hideButton(this.buttonCancel);this._hideElement(this.textBoxName);this._hideElement(this.label);this._hideElement(this.validationSummary);this._hideElement(this.requiredFieldValidator);this._hideElement(this.nameUniqueValidator)},_hideButton:function(b){b.parent().hide()},_showButton:function(b){b.parent().show()},_hideElement:function(b){b.hide()},_showElement:function(b){b.show()}})})(jQuery);(function(a){a.widget("ui.kpiEditor",{_init:function(){var e=this,d=this.options;this.editorState={initial:1,editKpi:2,addKpi:3};this.currentState=this.editorState.initial;this.settingsHidden=d.uiElements.settingsHidden;this.kpiItemSelector=a(d.uiElements.kpiItemSelector);this.kpiItemRegionSelector=a(d.uiElements.kpiItemRegionSelector);this.kpiList=d.kpiList;this.settingsPanel=a("#"+d.uiElements.settingsPanelID);this.addKpiElement=a("#"+d.uiElements.addKpiElementID);this.hideWhenEditorShownElement=a("#"+d.uiElements.hideWhenEditorShownElementID);this.hideSettingsElement=a("#"+d.uiElements.hideSettingsElementID);this.saveElement=a("#"+d.uiElements.saveElementID);this.resetElement=a("#"+d.uiElements.resetElementID);this.settingsTitleElement=a("#"+d.uiElements.settingsTitleElementID);this.kpiIDControl=a("#"+d.uiElements.kpiIDControlID);this.kpiNameControl=a("#"+d.uiElements.kpiNameControlID);this.kpiValueControl=a("#"+d.uiElements.kpiValueControlID);this.kpiExpectedValueControl=a("#"+d.uiElements.kpiExpectedValueControlID);this.kpiTypeControl=a("#"+d.uiElements.kpiTypeControlID);this.validators=a(d.uiElements.validatorSelector);this.validationSummary=a("#"+d.uiElements.validationSummaryID);a.each(d.kpiTypeData,function(f,g){if(g.selectControl&&g.editControl){g.selectControl.change(function(h){e._updateSettingsForSelected(g)})}});this.kpiItemSelector.click(function(f){e._selectKpi(this)});this.kpiItemSelector.hover(function(f){a(this).css("cursor","pointer")},function(f){a(this).css("cursor","default")});this.addKpiElement.click(function(f){e._addKpi()});this.hideSettingsElement.click(function(f){e._hideSettings()});this.resetElement.click(function(f){e._reset()});this.kpiTypeControl.change(function(f){e._updateSettingsForKpiType()});this.kpiTypeControl.change();if(d.uiElements.settingsHidden&&a("#"+d.uiElements.validationSummaryID).text().trim()==""){this._hideSettings()}else{this._showSettings();var b=this.kpiIDControl.val();if(b){var c=this.kpiItemSelector.filter("#"+b);if(c){this._selectKpiInList(c)}}}},_setSelectedOption:function(d,e){var c=a("option",d);var b=false;c.each(function(){if(a(this).val()==e){d.val(e);b=true}});return b},_addKpi:function(){this._reset();this.currentState=this.editorState.addKpi;this._showSettings()},_showSettings:function(b){if(!b||this.settingsHidden){if(this.hideWhenEditorShownElement){this.hideWhenEditorShownElement.hide()}this.settingsPanel.show();this.settingsPanel.find(":input:enabled:eq(0)").focus();this.settingsHidden=false}},_hideSettings:function(){if(!this.settingsHidden){this.settingsPanel.hide();this.settingsHidden=true;if(this.hideWhenEditorShownElement){this.hideWhenEditorShownElement.show()}}},_reset:function(){this.currentState=this.editorState.initial;this._resetKpiList();this._resetSettings()},_resetSettings:function(){this.kpiTypeControl.val("");this.kpiIDControl.val("");this.kpiNameControl.val("");this.kpiValueControl.val("");this.kpiExpectedValueControl.val("");for(var b in this.options.kpiTypeData){var c=this.options.kpiTypeData[b];if(c.editControl){c.editControl.val("");c.editControl.removeAttr("disabled")}if(c.selectControl){c.selectControl.val("");c.selectControl.removeAttr("disabled")}}this.validators.hide();this.validationSummary.hide();this.kpiTypeControl.removeAttr("disabled");this.kpiTypeControl.change();this._updateSettingTexts()},_resetKpiList:function(){this.kpiItemRegionSelector.removeClass(this.options.uiElements.kpiItemSelectedClass)},_selectKpiInList:function(b){this._resetKpiList();a(b).parents(this.options.uiElements.kpiItemRegionSelector).addClass(this.options.uiElements.kpiItemSelectedClass)},_fillSettings:function(c,h,f,i,b,g){this.kpiIDControl.val(c);this.kpiTypeControl.val(h);this.kpiNameControl.val(f);this.kpiValueControl.val(i);this.kpiExpectedValueControl.val(b);for(var d in this.options.kpiTypeData){var e=this.options.kpiTypeData[d];if(e.typeName==h){if(e.selectControl){if(!g||g==""||!this._setSelectedOption(e.selectControl,g)){e.selectControl.val(this.options.uiElements.manualInputValue)}if(!this.options.uiElements.canEditKpiParameter){e.selectControl.attr("disabled",true)}}if(e.editControl){e.editControl.val(g);if(!this.options.uiElements.canEditKpiParameter){e.editControl.attr("disabled",true)}}break}}this.kpiTypeControl.change();this.kpiTypeControl.attr("disabled",true)},_selectKpi:function(b){var e=a(b).attr("id").replace("kpi_","");var f;for(var c in this.kpiList){var d=this.kpiList[c];if(d.id==e){f=d;break}}if(!f){return}this.currentState=this.editorState.editKpi;this._selectKpiInList(b);this.validators.hide();this.validationSummary.hide();this._fillSettings(d.id,d.type,d.name,d.value,d.expectedValue,d.parameter);this._updateSettingTexts();this._showSettings()},_updateSettingTexts:function(){switch(this.currentState){case this.editorState.editKpi:this.saveElement.val(this.options.uiTexts.editKpiButtonText);this.settingsTitleElement.text(this.options.uiTexts.editKpiTitleText);break;case this.editorState.initial:case this.editorState.addKpi:default:this.saveElement.val(this.options.uiTexts.addKpiButtonText);this.settingsTitleElement.text(this.options.uiTexts.addKpiTitleText);break}},_updateSettingsForKpiType:function(){var e=this.kpiTypeControl.val();if(!e){return}for(var b in this.options.kpiTypeData){var d=this.options.kpiTypeData[b];var c=d.typeName==e;if(c){if(d.editPanel){d.editPanel.show()}if(d.selectControl&&d.editControl){d.selectControl.change()}}else{if(d.editPanel){d.editPanel.hide()}}for(var g in d.validators){var f=a("#"+d.validators[g])[0];ValidatorEnable(f,c)}}},_updateSettingsForSelected:function(b){var d=b.selectControl.val();if(d&&d!=this.options.uiElements.manualInputValue){var c=a("option[selected]",b.selectControl);if(c.length>0){b.selectControl.attr("title",c.text())}b.editControl.val(d);b.editControl.hide();a("label[for='"+b.editControl.attr("id")+"']").hide();a.each(b.validators,function(e,f){var g=a("#"+f)[0];ValidatorEnable(g,false)})}else{b.selectControl.attr("title","");a("label[for='"+b.editControl.attr("id")+"']").show();if(this.currentState==this.editorState.addKpi){b.editControl.val("")}b.editControl.show();a.each(b.validators,function(e,f){var g=a("#"+f)[0];ValidatorEnable(g,true)})}}});a.extend(a.ui.kpiEditor,{defaults:{uiElements:{settingsPanelID:"",kpiIDControlID:"",kpiNameControlID:"",kpiValueControlID:"",kpiExpectedValueControlID:"",kpiTypeControlID:"",canEditKpiParameter:true,manualInputValue:"DC3009E4E9B841D39F0C47029D7556B7",validatorSelector:"",validationSummaryID:"",addKpiElementID:"",hideWhenEditorShownElementID:"",hideSettingsElementID:"",resetElementID:"",saveElementID:"",settingsTitleElementID:"",kpiItemSelector:"",kpiItemRegionSelector:"",kpiItemSelectedClass:"",settingsHidden:true},uiTexts:{addKpiButtonText:"Add",editKpiButtonText:"Apply",addKpiTitleText:"New KPI",editKpiTitleText:"Edit KPI"},kpiList:[],kpiTypeData:[]}})})(jQuery);var EPi;if(!EPi){EPi={}}EPi.TreeView=function(b){this.OnNodeSelected=null;this.OnContextMenu=null;this.OnNodeMoved=null;this.OnNodeOver=null;this.OnNodePopulated=null;this.OnNodeMouseDown=null;this.MultiSelectEnabled=false;this.ForgetNodesOnMinimize=true;this.ExpandOnSelect=true;this.DragAndDropEnabled=true;var a=false;this._treeContainer=document.getElementById(b);this._selectedNodes=new EPi.SelectBuffer();this._dragViewer=new EPi.TreeView.DragMarker(this._treeContainer);this._setSelected="";this._dragSource=null;this._dragActive=false;this._dragOverElement=null;this._mdX=0;this._mdY=0;this._treeContainerOffset=EPi.GetOffset(this._treeContainer);this._Init=function(c){if(!a){var f=this;EPi.AddEventListener(this._treeContainer,"click",function(g){f.NodeClicked(g)});EPi.AddEventListener(this._treeContainer,"mousedown",function(g){f.MouseDown(g)});EPi.AddEventListener(this._treeContainer,"mouseover",function(g){f.MouseOver(g)});EPi.AddEventListener(this._treeContainer,"mouseout",function(g){f.MouseOut(g)});EPi.AddEventListener(this._treeContainer,"mouseup",function(g){f.MouseUp(g)});EPi.AddEventListener(this._treeContainer,"contextmenu",function(g){f.ContextMenu(g)});EPi.AddEventListener(document,"mousemove",function(g){f.MouseMove(g)});EPi.AddEventListener(document,"keydown",function(g){f.KeyDown(g)});EPi.AddEventListener(document,"click",this.DocumentClick);this._selectedNodes.addCallback=function(g){f.HighLightNode(g)};this._selectedNodes.deleteCallback=function(g){f.LowLightNode(g)};if(this._setSelected!=null&&this._setSelected!=""){this.SelectNode(this.GetNodeFromDataPath(this._setSelected),false)}if(c!=null){c(f)}this._scrollNode=document.documentElement;var e;var d=this._treeContainer;while(d.parentNode){e=EPi.GetCurrentStyle(d,"overflow");if(e=="auto"||e=="scroll"){this._scrollNode=d;break}d=d.parentNode}a=true}}};EPi.TreeView.prototype.NavigateToNode=function(b,a){if(b==null){return}if(a==null){a=true}var c=this.GetListNode(b);if(c){if(a){this.CollapseOtherSiblings(c);this.ExpandNode(c)}this.ExpandParentNodes(c);this.SelectNode(c,false)}else{this._selectedNodes.Clear();this._selectedNodes.Add(b);this.DoCallback(this._treeContainer,"select",b)}};EPi.TreeView.prototype.RefreshChildren=function(a){var b=this.GetNodeFromDataPath(a);if(b){this.PopulateNode(b)}else{this.DoCallback(this._treeContainer,"select",a)}};EPi.TreeView.prototype.RefreshNodeData=function(a){var b=this.GetNodeFromDataPath(a);if(b){this.DoCallback(b,"update",EPi.GetProperty(b,"datapath"))}};EPi.TreeView.prototype.RefreshParent=function(a){var b=this.GetNodeFromDataPath(a);if(b!=null){var c=this.ParentNode(b,"LI");if(c!=null){this.PopulateNode(c)}}else{this.DoCallback(this._treeContainer,"select",a)}};EPi.TreeView.prototype.RefreshChildrenIfVisible=function(a){var b=this.GetNodeFromDataPath(a);if(b&&(this.IsExpanded(b)||!this.CanExpand(b))){this.PopulateNode(b)}};EPi.TreeView.prototype.GetNodeFromDataPath=function(a){return this.GetListNode(a)};EPi.TreeView.prototype.GetSelectedNodes=function(){return this._selectedNodes.GetBuffer()};EPi.TreeView.prototype.GetTemplateContainer=function(a){var b=this.GetListNode(a);return this.getContainerNode(b)};EPi.TreeView.prototype.GetPropertyValue=function(a,c){var b=this.GetListNode(a);if(b!=null){return EPi.GetProperty(b,c,null,false)}return null};EPi.TreeView.prototype.DocumentClick=function(a){if(a.ctrlKey&&a.target.tagName=="A"&&this.MultiSelectEnabled){a.preventDefault();a.stopPropagation()}};EPi.TreeView.prototype.ContextMenu=function(a){if(this.OnContextMenu!=null){var c=this.ParentNode(a.target,"SPAN");var b=(c?this.ParentNode(c,"LI"):null);this.OnContextMenu(a,b)}};EPi.TreeView.prototype.KeyDown=function(a){switch(a.keyCode){case 27:this.AbortDrag(a);break;case 37:this.MoveFocusLeft(a);break;case 38:this.MoveFocusUp(a);break;case 39:this.MoveFocusRight(a);break;case 40:this.MoveFocusDown(a);break;case 13:case 32:this.MouseDown(a);this.NodeClicked(a);break;case 46:break}};EPi.TreeView.prototype.NodeClicked=function(a){var d=this.ParentNode(a.target,"SPAN");if(EPi.CSSUtility.HasClass(d,this._templateContainerClass)&&!(this.MultiSelectEnabled&&a.ctrlKey)){var b=this.ParentNode(d,"LI");var c=this.GetDataPath(b);if(this.ExpandOnSelect){this.ExpandNode(b)}if(this.OnNodeSelected){this.OnNodeSelected(c)}a.preventDefault()}};EPi.TreeView.prototype.MouseUp=function(f){if(this._dragActive){var c=this.ParentOrSelf(f.target,"SPAN");var b=this.ParentNode(c,"LI");if(b!=null&&this._dragSource!=null){if(this.OnNodeMoved!=null){var d=null;if(EPi.CSSUtility.HasClass(c,this._separatorContainerClass)){var g=this.PreviousNode(b,"LI");b=this.ParentNode(b,"LI");d=0;while(g!=null){g=this.PreviousNode(g,"LI");d++}if(this.PreviousNode(c,"SPAN",this._templateContainerClass)!=null){d++}}var i=this.GetDataPath(this._dragSource);var a=this.GetDataPath(b);var h=this.ParentNode(this.ParentNode(this._dragSource));var j=this.GetDataPath(h);this.OnNodeMoved(i,a,f.ctrlKey,d,j)}else{var k=this.FirstChild(b,"UL");if(k==null){k=document.createElement("UL");b.appendChild(k)}k.appendChild(this._dragSource);this.ExpandNode(b)}}this.AbortDrag(f)}this._dragSource=null};EPi.TreeView.prototype.AbortDrag=function(b){if(this._dragActive){this._dragViewer.Hide();if(this._dragOverElement){if(EPi.CSSUtility.HasClass(this._dragOverElement,this._separatorContainerClass)){EPi.CSSUtility.SwapClass(this._dragOverElement,this._highlightClass,"")}else{var a=this.GetDataPath(this.ParentOrSelf(this._dragOverElement,"LI"));if(this._selectedNodes.Find(a)==null){this.LowLightNode(a)}}}this._dragOverElement=null;this._dragActive=false}this._dragSource=null};EPi.TreeView.prototype.MouseMove=function(b){if(this._dragSource){if(!this._dragActive&&(Math.abs(b.clientX-this._mdX)>5||Math.abs(b.clientY-this._mdY)>5)){var a=this.getContainerNode(this._dragSource);var d=this.getTextContent(a);this._dragViewer.SetText(d);this._dragViewer.Show();this._dragActive=true}if(this._dragActive){var c=this._scrollNode;if(b.clientY<30&&c.scrollTop>0){if(c==document.documentElement){window.scrollBy(0,-15)}else{c.scrollTop=c.scrollTop-15}}else{if(b.clientY+30>c.offsetHeight&&c.scrollTop+c.offsetHeight<c.scrollHeight){if(c==document.documentElement){window.scrollBy(0,15)}else{c.scrollTop=c.scrollTop+15}}}this._dragViewer.Move(b.clientX-this._treeContainerOffset[0]+c.scrollLeft+2,b.clientY-this._treeContainerOffset[1]+c.scrollTop+2)}b.preventDefault();b.stopPropagation()}};EPi.TreeView.prototype.MouseOver=function(b){if(this._dragActive){var d=this.ParentOrSelf(b.target,"SPAN");if(EPi.CSSUtility.HasClass(d,this._templateContainerClass)){var c=this.ParentNode(d,"LI");var a=this.GetDataPath(c);if(this._selectedNodes.Find(a)==null){this.HighLightNode(a);this._dragOverElement=d}}else{if(EPi.CSSUtility.HasClass(d,this._iconClass)){var c=this.ParentNode(b.target,"LI");this.ExpandNode(c)}else{if(EPi.CSSUtility.HasClass(d,this._separatorContainerClass)){EPi.CSSUtility.AddClass(d,this._highlightClass);this._dragOverElement=d}}}}else{if(this.OnNodeOver!=null){var d=this.ParentOrSelf(b.target,"SPAN");if(EPi.CSSUtility.HasClass(d,this._templateContainerClass)){var c=this.ParentNode(d,"LI");if(c!=null){this.OnNodeOver(d,c)}}}}};EPi.TreeView.prototype.MouseOut=function(b){if(this._dragActive){var d=this.ParentOrSelf(b.target,"SPAN");if(EPi.CSSUtility.HasClass(d,this._templateContainerClass)){var c=this.ParentNode(d,"LI");var a=this.GetDataPath(c);if(this._selectedNodes.Find(a)==null){this.LowLightNode(a)}}else{if(EPi.CSSUtility.HasClass(d,this._separatorContainerClass)){EPi.CSSUtility.SwapClass(d,this._highlightClass,"")}}}};EPi.TreeView.prototype.MouseDown=function(a){var c=a.target;if(!c){return}var d=this.ParentOrSelf(c,"SPAN");var b=this.ParentNode(d,"LI");if(EPi.CSSUtility.HasClass(d,this._iconClass)){this.ToggleNode(b)}else{if(EPi.CSSUtility.HasClass(d,this._templateContainerClass)){if(this.DragAndDropEnabled&&a.button==0){this._mdX=a.clientX;this._mdY=a.clientY;this._dragSource=b}if(this.OnNodeMouseDown!=null){this.OnNodeMouseDown(a,b)}this.SelectNode(b,(a.ctrlKey&&this.MultiSelectEnabled));if(a.button==0){a.preventDefault()}}}};EPi.TreeView.prototype.MoveFocusLeft=function(a){var b=this.ParentNode(a.target,"LI");if(b){if(this.IsExpanded(b)){this.CollapseNode(b)}else{var c=this.ParentNode(b,"LI");this.FocusFirstAnchor(c)}}};EPi.TreeView.prototype.MoveFocusRight=function(a){var b=this.ParentNode(a.target,"LI");if(b){if(this.CanExpand(b)){this.ExpandNode(b)}else{if(this.IsExpanded(b)){this.MoveFocusDown(a)}}}};EPi.TreeView.prototype.MoveFocusDown=function(a){var b=this.ParentNode(a.target,"LI");if(b){var c=null;if(this.IsExpanded(b)){c=this.FirstChild(this.FirstChild(b,"UL"),"LI")}else{c=this.NextNode(b,"LI")}if(!c){var d=b;while(!c&&d){d=this.ParentNode(d,"LI");c=this.NextNode(d,"LI")}}if(c){this.FocusFirstAnchor(c);return true}}return false};EPi.TreeView.prototype.MoveFocusUp=function(b){var c=this.ParentNode(b.target,"LI");if(c){var d=this.PreviousNode(c,"LI");if(!d){d=this.ParentNode(c,"LI")}else{if(this.IsExpanded(d)){var a=d;do{d=a;a=this.LastChild(this.FirstChild(a,"UL"),"LI")}while(a)}}if(d){this.FocusFirstAnchor(d);return true}}return false};EPi.TreeView.prototype.FocusFirstAnchor=function(b){if(!b){return}var a=b.getElementsByTagName("A");if(a.length){a[0].focus()}};EPi.TreeView.prototype.GetDataPath=function(a){if(a==null){return null}return a.id.substr(this._treeContainer.id.length+1)};EPi.TreeView.prototype.GetListNode=function(a){return document.getElementById(this._treeContainer.id+"_"+a)};EPi.TreeView.prototype.IsExpanded=function(a){var b=this.getExpanderNode(a);return EPi.CSSUtility.HasClass(b,this._collapseClass)};EPi.TreeView.prototype.CanExpand=function(a){var b=this.getExpanderNode(a);return EPi.CSSUtility.HasClass(b,this._expandClass)};EPi.TreeView.prototype.ToggleNode=function(a){if(this.IsExpanded(a)){this.CollapseNode(a)}else{this.ExpandNode(a)}};EPi.TreeView.prototype.CollapseNode=function(a){if(this.IsExpanded(a)){var b=this.getExpanderNode(a);var c=this.FirstChild(a,"UL");EPi.CSSUtility.SwapOrAddClass(b,this._collapseClass,this._expandClass);if(this.ForgetNodesOnMinimize){EPi.SetProperty(a,"state","populate");if(c){a.removeChild(c)}}else{EPi.CSSUtility.SwapOrAddClass(c,this._showClass,this._hideClass)}}};EPi.TreeView.prototype.CollapseOtherSiblings=function(c){var e=c.parentNode.childNodes;var b=e.length;for(var a=0;a<b;a++){if(e[a].tagName=="LI"&&e[a]!=c){this.CollapseNode(e[a])}}var d=this.ParentNode(c,"LI");if(d!=null){this.CollapseOtherSiblings(d)}};EPi.TreeView.prototype.ExpandParentNodes=function(a){var b=this.ParentNode(a,"LI");if(b!=null){this.ExpandNode(b);this.ExpandParentNodes(b)}};EPi.TreeView.prototype.ExpandNode=function(a){if(!this.IsExpanded(a)&&this.CanExpand(a)){var b=EPi.GetProperty(a,"state");switch(b){case"populate":this.PopulateNode(a);break;default:var d=this.FirstChild(a,"UL");var c=this.getExpanderNode(a);EPi.CSSUtility.SwapOrAddClass(c,this._expandClass,this._collapseClass);EPi.CSSUtility.SwapOrAddClass(d,this._hideClass,this._showClass)}}};EPi.TreeView.prototype.PopulateNode=function(b){var a=EPi.GetProperty(b,"datapath");var c=this.getExpanderNode(b);EPi.SetProperty(b,"state","loading");EPi.CSSUtility.SwapOrAddClass(c,EPi.CSSUtility.ClassCombine(this._expandClass,this._collapseClass,this._leafNodeClass),this._loadClass);this.DoCallback(b,"populate",a)};EPi.TreeView.prototype.DoCallback=function(a,d,c){var b={populationNode:a,treeViewObject:this};var e=this;window.setTimeout(function(){_PageTreeView_doCallback(e._treeContainer.id,b,d,c,e.PopulateCallback,e.PopulateErrorCallback)},0)};EPi.TreeView.prototype.PopulateCallback=function(result,contextObject){var contextNode=contextObject.populationNode;var treeView=contextObject.treeViewObject;var newDiv=document.createElement("div");newDiv.innerHTML=result;var containerList=newDiv.getElementsByTagName("div");var scriptContainers=newDiv.getElementsByTagName("script");var htmlContainer=null;var scriptContainer=null;var scriptBlock=null;for(var i=0;i<containerList.length;i++){if(containerList[i].id=="htmlData"){htmlContainer=containerList[i]}}for(var j=0;j<scriptContainers.length;j++){if(scriptContainers[j].id=="scriptData"){scriptContainer=scriptContainers[j]}}var childNodes=treeView.FirstChild(htmlContainer,"UL");var treeNode=treeView.FirstChild(htmlContainer,"LI");if(childNodes||treeNode){var state="expanded";if(treeNode){var existingTemplateContainer=treeView.getContainerNode(contextNode);var newTemplateContainer=treeView.getContainerNode(treeNode);existingTemplateContainer.parentNode.replaceChild(newTemplateContainer,existingTemplateContainer);state=EPi.GetProperty(contextNode,"state")}else{var spanNode=treeView.getExpanderNode(contextNode);var existingChildNodes=treeView.FirstChild(contextNode,"UL");if(existingChildNodes){contextNode.replaceChild(childNodes,existingChildNodes)}else{contextNode.appendChild(childNodes);EPi.CSSUtility.SwapOrAddClass(contextNode,treeView._leafNodeClass,treeView._parentNodeClass)}EPi.CSSUtility.SwapOrAddClass(spanNode,treeView._loadClass,treeView._collapseClass)}if(scriptContainer){scriptBlock=eval(scriptContainer.innerHTML);if(typeof(scriptBlock)=="function"){scriptBlock()}}EPi.SetProperty(contextNode,"state",state);treeView._selectedNodes.EnsureSelected();if(treeView.OnNodePopulated){treeView.OnNodePopulated(treeView.GetDataPath(contextNode))}}else{var spanNode=treeView.getExpanderNode(contextNode);EPi.SetProperty(contextNode,"state","closed");EPi.CSSUtility.SwapClass(spanNode,treeView._collapseClass,"");EPi.CSSUtility.SwapOrAddClass(spanNode,treeView._loadClass,treeView._leafNodeClass);EPi.CSSUtility.SwapOrAddClass(contextNode,treeView._parentNodeClass,treeView._leafNodeClass);var childContainer=treeView.FirstChild(contextNode,"UL");if(childContainer){contextNode.removeChild(childContainer)}}};EPi.TreeView.prototype.PopulateErrorCallback=function(b,a){if(b.indexOf("not found")!=-1){return}alert("Error: "+b)};EPi.TreeView.prototype.HighLightNode=function(b){var c=this.GetListNode(b);if(c){var a=this.getContainerNode(c);if(a){EPi.CSSUtility.AddClass(a,this._selectedClass)}}};EPi.TreeView.prototype.LowLightNode=function(b){var c=this.GetListNode(b);if(c){var a=this.getContainerNode(c);if(a){EPi.CSSUtility.SwapClass(a,this._selectedClass,"")}}};EPi.TreeView.prototype.SelectNode=function(b,a){if(!this.HasTagName(b,"LI")){b=this.ParentNode(b,"LI")}if(!a){this._selectedNodes.Clear()}this.FocusFirstAnchor(b);this._selectedNodes.Add(this.GetDataPath(b))};EPi.TreeView.prototype.getTextContent=function(c){if(c.nodeType==3){return c.nodeValue}else{if(c.nodeType==1){var a=c.childNodes.length;var d="";for(var b=0;b<a;b++){d+=this.getTextContent(c.childNodes[b])}return d}}return""};EPi.TreeView.prototype.getContainerNode=function(a){var b=null;if(a!=null&&a.tagName=="LI"){return this.FirstChild(a,"SPAN",this._templateContainerClass)}return null};EPi.TreeView.prototype.getExpanderNode=function(a){if(a!=null&&a.tagName=="LI"){return this.FirstChild(a,"SPAN",this._iconClass)}return null};EPi.TreeView.prototype.PreviousNode=function(b,c,a){if(!b){return null}do{b=b.previousSibling}while(b!=null&&!this.HasTagNameAndClass(b,c,a));return b};EPi.TreeView.prototype.NextNode=function(b,c,a){if(!b){return null}do{b=b.nextSibling}while(b!=null&&!this.HasTagNameAndClass(b,c,a));return b};EPi.TreeView.prototype.LastChild=function(b,c,a){if(!b||!b.lastChild){return null}b=b.lastChild;if(this.HasTagNameAndClass(b,c,a)){return b}return this.PreviousNode(b,c,a)};EPi.TreeView.prototype.FirstChild=function(b,c,a){if(!b||!b.firstChild){return null}b=b.firstChild;if(this.HasTagNameAndClass(b,c,a)){return b}return this.NextNode(b,c,a)};EPi.TreeView.prototype.ParentNode=function(a,b){if(!a){return null}do{if(a==this._treeContainer){return null}a=a.parentNode}while(a!=null&&!this.HasTagName(a,b));return a};EPi.TreeView.prototype.ParentOrSelf=function(a,b){if(!a){return null}if(this.HasTagName(a,b)){return a}return this.ParentNode(a,b)};EPi.TreeView.prototype.HasTagName=function(a,b){if(b==null){return a}if(a&&a.nodeType==1){return(a.tagName==b.toUpperCase())}return false};EPi.TreeView.prototype.HasTagNameAndClass=function(b,c,a){if(!this.HasTagName(b,c)){return false}if(typeof a=="string"&&!EPi.CSSUtility.HasClass(b,a)){return false}return true};EPi.TreeView.DragMarker=function(a){this._marker=null;this._Init(a)};EPi.TreeView.DragMarker.prototype._Init=function(b){if(this._marker==null){var a=document.createElement("div");a.style.display="none";a.style.position="absolute";a.className="dragmarker";b.appendChild(a);this._marker=a}};EPi.TreeView.DragMarker.prototype.Show=function(){this._marker.style.display="block"};EPi.TreeView.DragMarker.prototype.Hide=function(){this._marker.style.display="none"};EPi.TreeView.DragMarker.prototype.Move=function(b,c){var a=this._marker;a.style.top=Math.max(0,c)+"px";a.style.left=Math.max(0,b)+"px"};EPi.TreeView.DragMarker.prototype.SetText=function(a){this._marker.innerHTML=a};EPi.SelectBuffer=function(){this._buffer=new Array();this.addCallback=null;this.deleteCallback=null};EPi.SelectBuffer.prototype.Add=function(a){if(this.Find(a)==null){this._buffer.push(a);this._ExecCallback(this.addCallback,a)}};EPi.SelectBuffer.prototype.EnsureSelected=function(){var b=(this._buffer?this._buffer.length:0);for(var a=0;a<b;a++){this._ExecCallback(this.addCallback,this._buffer[a])}};EPi.SelectBuffer.prototype._ExecCallback=function(a,b){if(a&&typeof(a)=="function"){a(b)}};EPi.SelectBuffer.prototype.Clear=function(){var b=this._buffer.length;for(var a=0;a<b;a++){this._ExecCallback(this.deleteCallback,this._buffer[a])}this._buffer=new Array()};EPi.SelectBuffer.prototype.Remove=function(b){var a=this.Find(b);if(a!=null){this._ExecCallback(this.deleteCallback,this._buffer[a]);this._buffer.splice(a,1)}};EPi.SelectBuffer.prototype.Find=function(b){var c=this._buffer.length;for(var a=0;a<c;a++){if(this._buffer[a]==b){return a}}return null};EPi.SelectBuffer.prototype.GetBuffer=function(){return this._buffer};EPi.SelectBuffer.prototype.Count=function(){return this._buffer.length};EPi.SelectBuffer.prototype.toString=function(){return this._buffer.join(",")};EPi.CSSUtility={};EPi.CSSUtility.CanHaveClass=function(a){return(a!=null&&a.className!=null)};EPi.CSSUtility.HasAnyClass=function(a){return(EPi.CSSUtility.CanHaveClass(a)&&(a.className.length>0))};EPi.CSSUtility.HasClass=function(a,b){return(b&&b.toString().length>0&&EPi.CSSUtility.HasAnyClass(a)&&(a.className.match(new RegExp(b,"i"))!=null))};EPi.CSSUtility.SwapOrAddClass=function(a,c,b){if(EPi.CSSUtility.HasClass(a,c)){EPi.CSSUtility.SwapClass(a,c,b)}else{EPi.CSSUtility.AddClass(a,b)}};EPi.CSSUtility.SwapClass=function(a,c,b){if(c&&c.toString().length>0&&EPi.CSSUtility.HasAnyClass(a)){a.className=a.className.replace(new RegExp(c,"gi"),b)}};EPi.CSSUtility.AddClass=function(b,a){if(EPi.CSSUtility.HasAnyClass(b)){if(!EPi.CSSUtility.HasClass(b,a)){b.className=b.className+" "+a}}else{if(EPi.CSSUtility.CanHaveClass(b)){b.className=a}}};EPi.CSSUtility.ClassCombine=function(){var a="";for(var b=0;b<arguments.length;b++){a+="|"+arguments[b]}return(a.length?a.substr(1):a)};$.widget("ui.list",{_init:function(){this._getTemplates();this._createList()},_getTemplates:function(){var a=this.element.children("div");this.templates=a.map(this._getTemplate).get()},_getTemplate:function(){var a=$(this);return{html:a.html(),func:a.attr("title"),style:a.attr("style"),css:a.attr("class")}},_createList:function(){this.element.empty();var a=this;$.each(this.options.items,function(b,c){a._createItem(b,c)})},_createItem:function(d,g){var f=this._findTemplate(d,g);if(!f){return}var b=$("<div>").appendTo(this.element);var a=f.css;if(a){a=this._replaceProperties(a,d,g);a=this._replaceFunctional(a,d,g);b.addClass(a)}var e=f.style;if(e){e=this._replaceProperties(e,d,g);e=this._replaceFunctional(e,d,g);b.attr("style",e)}var c=f.html;c=this._replaceProperties(c,d,g,true);c=this._replaceFunctional(c,d,g);b.html(c)},_findTemplate:function(index,value){for(var i=0;i<this.templates.length;i++){if(this.templates[i].func){var func=eval(this.templates[i].func);if($.isFunction(func)&&func(index,value,this.options.items)){return this.templates[i]}}}for(var i=0;i<this.templates.length;i++){if(!this.templates[i].func){return this.templates[i]}}return null},_normalizeString:function(c){var b="";for(var a=0;a<c.length;a++){b+="&#"+c.charCodeAt(a)+";"}return b},_replaceProperties:function(b,c,g,d){var e=new RegExp("\\[\\[index\\]\\]","ig");b=b.replace(e,c);var f=this;var a=function(h){var i=new RegExp("\\[\\["+h+"\\]\\]","ig");var j=d?f._normalizeString(this.toString()):this.toString();b=b.replace(i,j)};$.each(g,a);return b},_replaceFunctional:function(c,d,g){if(!$.isFunction(this.options.functional)){return c}var e=new RegExp("\\[\\[[^(\\[\\[)(\\]\\])]*\\]\\]","ig");var a=c.match(e);if(!a){return c}var f=this;var b=function(){var i=this.replace("[[","\\[\\[").replace("]]","\\]\\]");var k=new RegExp(i,"ig");var j=this.slice(2,-2);var h=f.options.functional(j,d,g,f.options.items);c=c.replace(k,h)};$.each(a,b);return c},_setData:function(a,b){$.widget.prototype._setData.apply(this,arguments);if(a!="items"){return}this._createList();this._trigger("onChange",null,null)},items:function(a){if(arguments.length){this._setData("items",a)}return this.options.items},insert:function(b,a){if(isNaN(a)||(a<0)||(a>this.options.items.length)){a=this.options.items.length}this.options.items.splice(a,0,b);this._createList();this._trigger("onInsert",null,b);this._trigger("onChange",null,b)},remove:function(a){if(isNaN(a)||(a<0)||(a>=this.options.items.length)){return}var b=this.options.items[a];this.options.items.splice(a,1);this._createList();this._trigger("onRemove",null,b);this._trigger("onChange",null,b)},moveUp:function(a){if(isNaN(a)||(a<0)||(a>=this.options.items.length-1)){return}var b=this.options.items[a];this.options.items.splice(a,2,this.options.items[a+1],this.options.items[a]);this._createList();this._trigger("onMoveUp",null,b);this._trigger("onChange",null,b)},moveDown:function(a){if(isNaN(a)||(a<=0)||(a>=this.options.items.length)){return}var b=this.options.items[a];this.options.items.splice(a-1,2,this.options.items[a],this.options.items[a-1]);this._createList();this._trigger("onMoveDown",null,b);this._trigger("onChange",null,b)},refresh:function(){this._createList()}});$.extend($.ui.list,{getter:"items",eventPrefix:"list",defaults:{items:[],functional:function(d,a,b,c){return},onRemove:function(a,b){return},onMoveUp:function(a,b){return},onMoveDown:function(a,b){return},onInsert:function(a,b){return},onChange:function(a,b){return}}});$.widget("ui.ddselector",{_init:function(){this.values=[this.element.selectedValues()[0]];this.element.css({visibility:"hidden",position:"absolute"});var b=this._getContainer();var c=this._getInputField();b.append(c);this.element.before(b);var a=this._getButton();var d=this._getInputLimiter(c);var e=this._getStyledSelector(d);c.append(d);c.append(a);$("body").append(e);this.oLimiter=d;this.oSelector=e;this.oInput=c;this.oButton=a;this.oContainer=b;this._adjustSelector();$("body").bind("click",this,function(f){f.data._hideDD(f.data)})},_getContainer:function(){var a=$("<span />").attr({"class":this.options.styleName});if(this.options.disabled){a.addClass("disabled")}return a},_getInputLimiter:function(a){var b=$("<span />").addClass("ddlimiter").css({width:a.width()-33});return b},_getButton:function(){var a=$("<a href='#' />").append($("<span />").attr({"class":"ddicon"}));return a.bind("keydown",this,function(c){var b=$("li.hover",$(c.data.oSelector));switch(c.keyCode){case 40:c.preventDefault();if(c.data.oSelector.is(":visible")){if(b.length==0){b=$("li:first",$(c.data.oSelector)).addClass("hover")}else{b.removeClass("hover");b=b.next();b.addClass("hover")}}else{c.data._showDD(c.data)}break;case 38:c.preventDefault();if(c.data.oSelector.is(":visible")){if(b.length==0){b=$("li:last",$(c.data.oSelector)).addClass("hover")}else{b.removeClass("hover");b=b.prev();b.addClass("hover")}}else{c.data._showDD(c.data)}break;case 27:c.preventDefault();c.data._hideDD(c.data);break;case 9:c.data._hideDD(c.data);break;case 13:c.preventDefault();if(b.length!=0){b.click()}break}}).bind("focus",this,function(b){b.data.oContainer.addClass("ui-ddselector-focused")}).bind("blur",this,function(b){b.data.oContainer.removeClass("ui-ddselector-focused")})},_getInputField:function(){var a=$("<div />").attr({"class":"ddvaluebox_div"}).bind("click",this,function(b){b.stopPropagation();b.data.focus();b.data._toggleDD(b.data)});return a},_adjustSelector:function(){var a=this.oContainer.offset();this.oSelector.css({top:a.top+this.oContainer.height(),left:a.left+1}).width(this.oContainer.width())},_showDD:function(a){if(!this.options.disabled){a._adjustSelector();a.oInput.blur();a.oButton.addClass("ddiconup");a.oSelector.show()}},_hideDD:function(a){if(!this.options.disabled){a.oInput.blur();a.oButton.removeClass("ddiconup");a.oSelector.hide()}},_toggleDD:function(a){if(!this.options.disabled){a._adjustSelector();a.oInput.blur();a.oButton.toggleClass("ddiconup");a.oSelector.toggle()}},_countCharNum:function(e,c){var b=this._getInputField().html(e).css({width:"auto"});var a=this._getContainer();a.css({position:"absolute",display:"none"});a.append(b);this.element.parent().before(a);var d=b.html().length;while(this.element.parent().width()-(c?c:0)<=a.width()){b.html(b.html().substring(0,d)+"...");d--}a.remove();return d},_cutString:function(c,b){if(!b){b=0}var a=this._countCharNum(c,b);if(a<c.length){return($.trim(c.substring(0,a))+"...")}else{return c}},_getStyledSelector:function(a){var c=this.element;var b=this;var d=new Array();var e=$("<ul />").hide().addClass("ui-ddselector-ul");this.element.children("option").each(function(){var g=$(this).val().split("|")[0];var f=$(this).val().split("|")[1];var h=$("<li />").attr({id:c.attr("id")+"_"+g,name:$(this).val(),title:$(this).html()});if(f){h.css("background","url('"+f+"') 2px 0px no-repeat")}else{h.css("padding-left","1px")}var i=$("<span>").html(b._cutString($(this).html())).appendTo(h);if($(this).is(":selected")){a.html(b._cutString($(this).html(),20)).attr("title",$(this).html());if(f){a.css("background","url('"+f+"') 2px 0px no-repeat")}else{a.css("padding-left","1px")}if(b.options.changeOnInit&&typeof b.options.onChange=="function"){b.options.onChange(g)}}if($(this).is(":last-child")){h.addClass("last")}e.append(h);$(h).mouseover(function(j){$("li",e).removeClass("hover");h.addClass("hover")}).mouseout(function(j){h.removeClass("hover")}).bind("click",c,function(j){var m=b.values[b.values.length-1];var l=$(this).attr("name");var k=l.split("|")[0];j.stopPropagation();b._hideDD(b);if(typeof b.options.onClick=="function"){b.options.onClick()}if((typeof b.options.onChange=="function")&&(m!=l)&&(b.options.onChange(k)!=false)){a.html(b._cutString($(this).text(),20));a.css("background",$(this).css("background")||"none");a.css("padding-left",$(this).css("padding-left"));j.data.selectOptions(l);b.values[b.values.length]=l}b.oButton.focus()})});return e},rollback:function(){if(this.values.length<2){return}var a=this.values[this.values.length-1];this.element.selectOptions(a)},destroy:function(){$.widget.prototype.apply(this,arguments)},focus:function(){this.oButton.focus()}});$.extend($.ui.ddselector,{defaults:{styleName:"ui-ddselector",onClick:null,onChange:null,disabled:false,changeOnInit:false}});var minDate=new Date("07/10/2010");var maxDate=new Date("10/18/2010");var previousRange;var dateFormat="dd.mm.yy";var parent;$.widget("ui.daterange",{_isVisible:false,_previousStartDate:null,_previousEndDate:null,_popup:null,_startViewElement:null,_endViewElement:null,_delimiterViewElement:null,_startDatePicker:null,_endDatePicker:null,_isDate:function(a){return(a&&"object"==typeof a)&&a.getMonth},_setPosition:function(){var b=this.element.offset().top-$(this.options.popupParent).offset().top+$(this.options.popupParent).scrollTop()+this.element.innerHeight()+1;var a=this.element.offset().left-$(this.options.popupParent).offset().left+$(this.options.popupParent).scrollLeft();if(this.options.popupAlign=="right"){a+=this.element.outerWidth()-this._popup.outerWidth()}this._popup.css({left:a,top:b})},_updateView:function(){this._startViewElement.text($.datepicker.formatDate(this.options.viewDateFormat,this.options.startDate));this._endViewElement.text($.datepicker.formatDate(this.options.viewDateFormat,this.options.endDate))},_setDate:function(b,a){this.options.startDate=(this._isDate(b))?b:new Date();this._startDatePicker.datepicker("setDate",this.options.startDate).datepicker("show");this.options.endDate=(this._isDate(a))?a:new Date();this._endDatePicker.datepicker("setDate",this.options.endDate)},_doRedirect:function(){var b=Cmo.getParsedGet();b[this.options.queryStartDateKey]=$.datepicker.formatDate(this.options.queryDateFormat,this.options.startDate);b[this.options.queryEndDateKey]=$.datepicker.formatDate(this.options.queryDateFormat,this.options.endDate);var c="?";for(var a in b){c+=(c!="?"?"&":"")+a+"="+b[a]}document.location.href=location.pathname+c},_init:function(){var a=this;this.element.addClass("ui-daterange");this._startViewElement=$("<span></span>").appendTo(this.element).addClass("ui-daterange-startDate");this._delimiterViewElement=$("<span></span>").appendTo(this.element).addClass("ui-daterange-delimiter").text(this.options.delimiter);this._endViewElement=$("<span></span>").appendTo(this.element).addClass("ui-daterange-endDate");this._startViewElement.bind("click",function(){a.show()});this._endViewElement.bind("click",function(){a.show()});this._popup=$("<div></div>").addClass("ui-daterange-popup").css({position:"absolute","z-index":5000}).hide();this._popup.appendTo(this.options.popupParent);var c=$("<div></div>").appendTo(this._popup).addClass("ui-daterange-datepickersArea");this._startDatePicker=$("<div></div>").appendTo(c).addClass("ui-daterange-startDatepicker").datepicker({minDate:this.options.minDate,maxDate:this.options.maxDate});this._endDatePicker=$("<div></div>").appendTo(c).addClass("ui-daterange-endDatepicker").datepicker({minDate:this.options.minDate,maxDate:this.options.maxDate});this._startDatePicker.datepicker("option",$.extend({showMonthAfterYear:false},$.datepicker.regional[this.options.lang]));this._endDatePicker.datepicker("option",$.extend({showMonthAfterYear:false},$.datepicker.regional[this.options.lang]));this._setDate(this.options.startDate,this.options.endDate);this._updateView();var b=$("<div></div>").appendTo(this._popup).addClass("ui-daterange-buttonsArea");$('<button type="button">Select</button>').appendTo(b).addClass("ui-daterange-button").bind("click",function(d){d.preventDefault();a.select()});$('<button type="button">Cancel</button>').appendTo(b).addClass("ui-daterange-button").bind("click",function(d){d.preventDefault();a.cancel()});this._startDatePicker.datepicker("option","onSelect",function(){a._selecting()});this._endDatePicker.datepicker("option","onSelect",function(){a._selecting()})},_selecting:function(){this.options.startDate=this._startDatePicker.datepicker("getDate");this.options.endDate=this._endDatePicker.datepicker("getDate");this._updateView();if(typeof this.options.onSelecting=="function"){this.options.onSelecting.call(this.element)}},show:function(){if(!this._isVisible){this._isVisible=true;this._previousStartDate=this.options.startDate;this._previousEndDate=this.options.endDate;this._setDate(this.options.startDate,this.options.endDate);this._setPosition();this._popup.show();if(typeof this.options.onShow=="function"){if(typeof this.options.onShow=="function"){this.options.onShow.call(this.element)}}}},hide:function(){if(this._isVisible){this._isVisible=false;this._popup.hide();if(typeof this.options.onHide=="function"){if(typeof this.options.onHide=="function"){this.options.onHide.call(this.element)}}}},select:function(){if(this.options.startDate<=this.options.endDate){if(this.options.startDate!=this._previousStartDate||this.options.endDate!=this._previousEndDate){this._doRedirect()}this.hide();if(typeof this.options.onSelect=="function"){this.options.onSelect.call(this.element)}}else{alert(this.options.wrongRangeMessage)}},cancel:function(){this._setDate(this._previousStartDate,this._previousEndDate);this._updateView();this.hide();if(typeof this.options.onCancel=="function"){this.options.onCancel.call(this.element)}},destroy:function(){$.Widget.prototype.destroy.apply(this,arguments)}});$.extend($.ui.daterange,{defaults:{viewDateFormat:"dd/mm/yy",queryDateFormat:"yy.mm.dd",queryStartDateKey:"",queryEndDateKey:"",minDate:null,maxDate:null,startDate:new Date(),endDate:new Date(),popupAlign:"right",popupParent:"body",delimiter:"?",lang:"",wrongRangeMessage:"",onSelecting:null,onSelect:null,onCancel:null,onShow:null,onHide:null}});(function(a){a.widget("ui.passwordInput",{_init:function(){var e=this,b=this.options;if(this.element.val()==""&&b.noPassword){return}this.element.hide();var f=a("<span />");f.attr("class",this.element.attr("class"));f.addClass("ui-passwordInput");var d=a("<span />");d.text("*******");var c=a("<input type='button' />");c.val(b.changeButtonText);c.click(function(g){f.hide();e.element.show();e.element.focus()});f.append(d);f.append(c);this.element.after(f)}});a.extend(a.ui.passwordInput,{defaults:{changeButtonText:"Change password",noPassword:true}})})(jQuery);jQuery.fn.positionAncestor=function(b){var a=0;var c=0;this.each(function(k,j){var d=$(this).closest(b);if(d.length&&d.css("position")!=="static"){var e=$(this);var h=e.offset().left-parseInt(e.css("marginLeft"),10);var i=e.offset().top-parseInt(e.css("marginTop"),10);var f=d.offset().left+parseInt(d.css("borderLeftWidth"),10);var g=d.offset().top+parseInt(d.css("borderTopWidth"),10);a=h-f;c=i-g;return false}});return{left:a,top:c}};var mouseX=0;var mouseY=0;$().mousemove(function(a){mouseX=a.clientX;mouseY=a.clientY});var Cmo;if(!Cmo){Cmo={}}Cmo.ShowAlert=function(a){alert(a)};Cmo.ShowConfirmation=function(b,c,a){var d=confirm(b);if(d&&c!=undefined){c.call(this)}else{if(a!=undefined){a.call(this)}}return d};Cmo.CreateOverlay=function(a){var b=$('<div class="ui-widget-overlay">');if($.browser.msie&&$.browser.version<7){b.css({height:Cmo.GetDocumentHeightForIE6(),"z-index":Cmo.GetHeighestZIndex()})}else{b.css({"z-index":Cmo.GetHeighestZIndex(),position:"fixed"})}b.attr("id",a);return b};Cmo.GetDocumentHeightForIE6=function(){var b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);var a=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(b<a){return $(window).height()+"px"}else{return b+"px"}};Cmo.GetHeighestZIndex=function(){var a=Math.max.apply(null,$.map($("body > *"),function(b,c){if($(b).css("position")=="absolute"&&$(b).hasClass("ui-dialog")){return parseInt($(b).css("z-index"))+1||2}else{return 2}}));return a};Cmo.getParsedGet=function(){var c=new Array();var e=new Array();var b=new Array();var d=location.search;if(d!=""){c=(d.substr(1)).split("&");for(var a=0;a<c.length;a++){e=c[a].split("=");b[e[0]]=e[1]}}return b};Cmo.PrintPage=function(){var a=window.location.href;var b="";if(a.indexOf("#")!=-1){b=a.substring(a.indexOf("#"),a.length);a=a.replace(/#\S*/,"")}if(a.indexOf("?")>-1){a=a+"&print=true"}else{a=a+"?print=true"}a+=b;window.open(a)};Cmo.SetupDatePicker=function(a,c,b,d){var e=a.val();if(c){a.datepicker($.datepicker.regional[c])}a.datepicker({showOtherMonths:true,showOn:"button",buttonImageOnly:false,showMonthAfterYear:false});a.datepicker("option","minDate",d);if(b){a.datepicker("option","dateFormat",b)}a.datepicker("option","duration",0);if(a.attr("disabled")){a.datepicker("disable")}a.val(e);a.focus(function(){if(a.val()==""){a.datepicker("show")}});a.change(function(){EPi.PageLeaveCheck.SetPageChanged(true)})};Cmo.ValidateDate=function(b,a){a.IsValid=jQuery.trim(a.Value).length!=0};Cmo.DisablePageLeaveCheck=function(){EPi.PageLeaveCheck.enabled=false};Cmo.ReloadPage=function(){window.location.href=window.location.href};Cmo.KpiReportUpdate=function(gaugeClientId,hiddenClientId){var data=$("#"+hiddenClientId).val();var dataObj=eval("("+data+")");$.each(dataObj.textdata,function(index,value){if($("#"+index).length>0){$("#"+index).text(value)}});$.each(dataObj.cssdata,function(index,value){if($("#"+index).length>0){$("#"+index).removeClass();$("#"+index).addClass(value)}});var gauge=$("#"+gaugeClientId)[0];if(gauge&&gauge.isLoaded){gauge.Content.CMGauge.UpdateGaugeValues(dataObj.gaugedata.AchievedValue,dataObj.gaugedata.EstimatedValue,false)}};Cmo.IsPageSelectorItemDeleted=function(index,item){return eval(item.deleted)};Cmo.ClearMessage=function(){$(".CMO-systemMessage",".bodyMain").remove()};var Cmo;if(!Cmo){Cmo={}}Cmo.CampaignPageSelector=function(d,g,f){var e=this;var b="ListType";var a=parseInt($.cookie(b));if(isNaN(a)){a=0}var c=f;this.items=d;this.views=g;this.activeView=function(){if((a<0)||(a>=e.views.length)){a=0}return e.views[a]};this.showView=function(h,i){h==a?i.show():i.hide()};this.buildView=function(i){var h=$.extend(c,{items:e.items});i.list(h);i.built=true};this.showList=function(){e.activeView().built?e.activeView().list("items",e.items):e.buildView(e.activeView());$.each(e.views,e.showView)};this.switchView=function(h){if(h==a){return}a=h;e.showList();$.cookie(b,h)}};var conversionPath={};conversionPath.listFunctional=function(d,a,b,c){switch(d){case"nameClass":return b.deleted?"deleted":"";case"removeLinkClass":return b.readonly?"hidden":"pageNameLink";case"selectedClass":return b.selected&&!b.readonly?"selectedPage":""}return""};conversionPath.replaceImgSrc=function(){this.src=this.title;this.title=this.alt};conversionPath.selectItem=function(a,c){var b=conversionPath.getElement(a);if(!b||!b.items[c]){return false}for(var d in b.items){b.items[d].selected=false}b.items[c].selected=true;conversionPath.update(b,false);return true};conversionPath.removeItem=function(a,c){var b=conversionPath.getElement(a);if(!b||!b.items[c]){return false}var d=b.items[c].selected;b.items[c]=conversionPath.getDefaultConversionPathItem(b);conversionPath.selectItem(b.divMain[0],c);conversionPath.update(b,true);return true};conversionPath.swapItems=function(a,c){var b=conversionPath.getElement(a);if(!b||!b.items[c]||!b.items[c+1]){return false}var d=b.items[c];b.items[c]=b.items[c+1];b.items[c+1]=d;conversionPath.update(b,true);return true};conversionPath.updateItem=function(a,c){var b=-1;for(var d in a.items){if(a.items[d].reference==c.reference){b=-1;break}if(a.items[d].selected&&!a.items[d].readonly){b=d}}if(!a.items[b]){return false}a.items[b]=c;a.items[b].selected=true;conversionPath.update(a,true);return true};conversionPath.show=function(a){var b=conversionPath.getElement(a);if(!b){return}b.divContent.show();b.spanHider.removeClass("collapsed");conversionPath.update(b,false);if($.isFunction(b.divMain[0].onShow)){b.divMain[0].onShow()}};conversionPath.hide=function(a){var b=conversionPath.getElement(a);if(!b){return}b.divContent.hide();b.spanHider.addClass("collapsed");if($.isFunction(b.divMain[0].onHide)){b.divMain[0].onHide()}};conversionPath.updateElement=function(a,c){var b=conversionPath.getElement(a);if(!b){return false}var d=conversionPath.updateItem(b,c);if(d&&$.isFunction(b.divMain[0].onUpdateElement)){b.divMain[0].onUpdateElement()}return d};conversionPath.setChangedState=function(b){var a=conversionPath.getElement(b.target);if(!a){return}if((b.type=="change")||(b.keyCode==8)||(b.keyCode>=46&&b.keyCode<=111)||(b.keyCode>=186&&b.keyCode<=222)){a.divMain[0].changed=true;a.buttonUpdate[0].disabled=""}};conversionPath.getElement=function(a){var b=$(a);while(b&&b.length){if(b[0].element){return b[0].element}b=b.parent()}return null};conversionPath.validate=function(b,a){a.IsValid=false;var d=conversionPath.getElement(b);if(!d){return}var c=0;for(var e in d.items){if(d.items[e].reference){c++}}a.IsValid=c>1};conversionPath.update=function(b,a){b.divList.list("refresh");b.divList.find("img").each(conversionPath.replaceImgSrc);b.divMain[0].changed=b.divMain[0].changed||a;b.buttonUpdate[0].disabled=b.divMain[0].changed?"":"disabled";var d="";for(var c in b.items){d+=","+b.items[c].reference}b.hiddenValue.val(d.substr(1))};conversionPath.removePath=function(script,text){Cmo.DisablePageLeaveCheck();var func=function(){eval(script)};Cmo.ShowConfirmation(text,func)};conversionPath.getDefaultConversionPathItem=function(b){var a={};for(var c in b.defaultItem){a[c]=b.defaultItem[c]}return a};function isEmptyConversionPathPage(a,b){return !(b&&b.reference)};if(!window.Silverlight){window.Silverlight={}}Silverlight._silverlightCount=0;Silverlight.__onSilverlightInstalledCalled=false;Silverlight.fwlinkRoot="http://go2.microsoft.com/fwlink/?LinkID=";Silverlight.__installationEventFired=false;Silverlight.onGetSilverlight=null;Silverlight.onSilverlightInstalled=function(){window.location.reload(false)};Silverlight.isInstalled=function(o){if(o==undefined){o=null}var n=false,z=null;try{var v=null,w=false;if(window.ActiveXObject){try{v=new ActiveXObject("AgControl.AgControl");if(o===null){n=true}else{if(v.IsVersionSupported(o)){n=true}}v=null}catch(y){w=true}}else{w=true}if(w){var x=navigator.plugins["Silverlight Plug-In"];if(x){if(o===null){n=true}else{var u=x.description;if(u==="1.0.30226.2"){u="2.0.30226.2"}var p=u.split(".");while(p.length>3){p.pop()}while(p.length<4){p.push(0)}var r=o.split(".");while(r.length>4){r.pop()}var q,t,s=0;do{q=parseInt(r[s]);t=parseInt(p[s]);s++}while(s<r.length&&q===t);if(q<=t&&!isNaN(q)){n=true}}}}}catch(y){n=false}return n};Silverlight.WaitForInstallCompletion=function(){if(!Silverlight.isBrowserRestartRequired&&Silverlight.onSilverlightInstalled){try{navigator.plugins.refresh()}catch(b){}if(Silverlight.isInstalled(null)&&!Silverlight.__onSilverlightInstalledCalled){Silverlight.onSilverlightInstalled();Silverlight.__onSilverlightInstalledCalled=true}else{setTimeout(Silverlight.WaitForInstallCompletion,3000)}}};Silverlight.__startup=function(){navigator.plugins.refresh();Silverlight.isBrowserRestartRequired=Silverlight.isInstalled(null);if(!Silverlight.isBrowserRestartRequired){Silverlight.WaitForInstallCompletion();if(!Silverlight.__installationEventFired){Silverlight.onInstallRequired();Silverlight.__installationEventFired=true}}else{if(window.navigator.mimeTypes){var f=navigator.mimeTypes["application/x-silverlight-2"],g=navigator.mimeTypes["application/x-silverlight-2-b2"],h=navigator.mimeTypes["application/x-silverlight-2-b1"],e=h;if(g){e=g}if(!f&&(h||g)){if(!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=true}}else{if(f&&e){if(f.enabledPlugin&&e.enabledPlugin){if(f.enabledPlugin.description!=e.enabledPlugin.description){if(!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=true}}}}}}}if(!Silverlight.disableAutoStartup){if(window.removeEventListener){window.removeEventListener("load",Silverlight.__startup,false)}else{window.detachEvent("onload",Silverlight.__startup)}}};if(!Silverlight.disableAutoStartup){if(window.addEventListener){window.addEventListener("load",Silverlight.__startup,false)}else{window.attachEvent("onload",Silverlight.__startup)}}Silverlight.createObject=function(z,s,r,x,y,u,w){var q={},n=x,p=y;q.version=n.version;n.source=z;q.alt=n.alt;if(u){n.initParams=u}if(n.isWindowless&&!n.windowless){n.windowless=n.isWindowless}if(n.framerate&&!n.maxFramerate){n.maxFramerate=n.framerate}if(r&&!n.id){n.id=r}delete n.ignoreBrowserVer;delete n.inplaceInstallPrompt;delete n.version;delete n.isWindowless;delete n.framerate;delete n.data;delete n.src;delete n.alt;if(Silverlight.isInstalled(q.version)){for(var o in p){if(p[o]){if(o=="onLoad"&&typeof p[o]=="function"&&p[o].length!=1){var v=p[o];p[o]=function(b){return v(document.getElementById(r),w,b)}}var t=Silverlight.__getHandlerName(p[o]);if(t!=null){n[o]=t;p[o]=null}else{throw"typeof events."+o+" must be 'function' or 'string'"}}}slPluginHTML=Silverlight.buildHTML(n)}else{slPluginHTML=Silverlight.buildPromptHTML(q)}if(s){s.innerHTML=slPluginHTML}else{return slPluginHTML}};Silverlight.buildHTML=function(d){var e=[];e.push('<object type="application/x-silverlight" data="data:application/x-silverlight,"');if(d.id!=null){e.push(' id="'+Silverlight.HtmlAttributeEncode(d.id)+'"')}if(d.width!=null){e.push(' width="'+d.width+'"')}if(d.height!=null){e.push(' height="'+d.height+'"')}e.push(" >");delete d.id;delete d.width;delete d.height;for(var f in d){if(d[f]){e.push('<param name="'+Silverlight.HtmlAttributeEncode(f)+'" value="'+Silverlight.HtmlAttributeEncode(d[f])+'" />')}}e.push("</object>");return e.join("")};Silverlight.createObjectEx=function(e){var d=e,f=Silverlight.createObject(d.source,d.parentElement,d.id,d.properties,d.events,d.initParams,d.context);if(d.parentElement==null){return f}};Silverlight.buildPromptHTML=function(f){var e="",h=Silverlight.fwlinkRoot,g=f.version;if(f.alt){e=f.alt}else{if(!g){g=""}e="<a href='javascript:Silverlight.getSilverlight(\"{1}\");' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>";e=e.replace("{1}",g);e=e.replace("{2}",h+"108181")}return e};Silverlight.getSilverlight=function(j){if(Silverlight.onGetSilverlight){Silverlight.onGetSilverlight()}var g="",f=String(j).split(".");if(f.length>1){var h=parseInt(f[0]);if(isNaN(h)||h<2){g="1.0"}else{g=f[0]+"."+f[1]}}var i="";if(g.match(/^\d+\056\d+$/)){i="&v="+g}Silverlight.followFWLink("149156"+i)};Silverlight.followFWLink=function(b){top.location=Silverlight.fwlinkRoot+String(b)};Silverlight.HtmlAttributeEncode=function(g){var e,f="";if(g==null){return null}for(var h=0;h<g.length;h++){e=g.charCodeAt(h);if(e>96&&e<123||e>64&&e<91||e>43&&e<58&&e!=47||e==95){f=f+String.fromCharCode(e)}else{f=f+"&#"+e+";"}}return f};Silverlight.default_error_handler=function(j,g){var i,h=g.ErrorType;i=g.ErrorCode;var f="\nSilverlight error message     \n";f+="ErrorCode: "+i+"\n";f+="ErrorType: "+h+"       \n";f+="Message: "+g.ErrorMessage+"     \n";if(h=="ParserError"){f+="XamlFile: "+g.xamlFile+"     \n";f+="Line: "+g.lineNumber+"     \n";f+="Position: "+g.charPosition+"     \n"}else{if(h=="RuntimeError"){if(g.lineNumber!=0){f+="Line: "+g.lineNumber+"     \n";f+="Position: "+g.charPosition+"     \n"}f+="MethodName: "+g.methodName+"     \n"}}alert(f)};Silverlight.__cleanup=function(){for(var b=Silverlight._silverlightCount-1;b>=0;b--){window["__slEvent"+b]=null}Silverlight._silverlightCount=0;if(window.removeEventListener){window.removeEventListener("unload",Silverlight.__cleanup,false)}else{window.detachEvent("onunload",Silverlight.__cleanup)}};Silverlight.__getHandlerName=function(e){var d="";if(typeof e=="string"){d=e}else{if(typeof e=="function"){if(Silverlight._silverlightCount==0){if(window.addEventListener){window.addEventListener("unload",Silverlight.__cleanup,false)}else{window.attachEvent("onunload",Silverlight.__cleanup)}}var f=Silverlight._silverlightCount++;d="__slEvent"+f;window[d]=e}else{d=null}}return d};Silverlight.onRequiredVersionAvailable=function(){};Silverlight.onRestartRequired=function(){};Silverlight.onUpgradeRequired=function(){};Silverlight.onInstallRequired=function(){};Silverlight.IsVersionAvailableOnError=function(h,e){var f=false;try{if(e.ErrorCode==8001&&!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=true}else{if(e.ErrorCode==8002&&!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=true}else{if(e.ErrorCode==5014||e.ErrorCode==2106){if(Silverlight.__verifySilverlight2UpgradeSuccess(e.getHost())){f=true}}else{f=true}}}}catch(g){}return f};Silverlight.IsVersionAvailableOnLoad=function(e){var d=false;try{if(Silverlight.__verifySilverlight2UpgradeSuccess(e.getHost())){d=true}}catch(f){}return d};Silverlight.__verifySilverlight2UpgradeSuccess=function(i){var h=false,g="4.0.50401",f=null;try{if(i.IsVersionSupported(g+".99")){f=Silverlight.onRequiredVersionAvailable;h=true}else{if(i.IsVersionSupported(g+".0")){f=Silverlight.onRestartRequired}else{f=Silverlight.onUpgradeRequired}}if(f&&!Silverlight.__installationEventFired){f();Silverlight.__installationEventFired=true}}catch(j){}return h};